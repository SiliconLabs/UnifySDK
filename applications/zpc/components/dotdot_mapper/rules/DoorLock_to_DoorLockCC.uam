// --------
// These attributes should be predefined from auto generated source code
// DoorLock Zwave attributes
def zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE 0x6207
def zwDOOR_LOCK_CAPABILITIES_SUPPORTED_DOOR_COMPONENTS 0x6217

def zwDOOR_LOCK_CONFIGURATION_OPERATION_TYPE 0x6202
def zwDOOR_LOCK_CONFIGURATION_INSIDE_DOOR_HANDLES_STATE 0x6203
def zwDOOR_LOCK_CONFIGURATION_OUTSIDE_DOOR_HANDLES_STATE 0x6204
def zwDOOR_LOCK_CONFIGURATION_LOCK_TIMEOUT_MINUTES 0x6205
def zwDOOR_LOCK_CONFIGURATION_LOCK_TIMEOUT_SECONDS 0x6206

def zwDOOR_LOCK_OPERATION_INSIDE_DOOR_HANDLES_MODE 0x6208
def zwDOOR_LOCK_OPERATION_OUTSIDE_DOOR_HANDLES_MODE 0x6209
def zwDOOR_LOCK_OPERATION_DOOR_CONDITION 0x620A
def zwDOOR_LOCK_OPERATION_LOCK_TIMEOUT_MINUTES 0x620B
def zwDOOR_LOCK_OPERATION_LOCK_TIMEOUT_SECONDS 0x620C

// UserCode Zwave attributes
def zwUSER_CODE_DATA 0x6302
def zwUSER_CODE_NUMBER_OF_USERS 0x6303
def zwUSER_CODE_CAPABILITIES 0x6309
def zwUSER_CODE_SUPPORTED_FLAGS 0x630A
def zwUSER_CODE_SUPPORTED_USER_ID_STATUS_BITMASK 0x630B
def zwUSER_CODE_SUPPORTED_KEYPAD_MODES_BITMASK 0x630C
def zwUSER_CODE_SUPPORTED_KEYS_BITMASK 0x630D

def zwUSER_CODE_KEYPAD_MODE 0x630F

// ZigBee DoorLock attributes
def zbDOOR_LOCK_CLUSTER_LOCK_STATE 0x01010000
def zbDOOR_LOCK_CLUSTER_LOCK_TYPE 0x01010001
def zbDOOR_LOCK_ACTUATOR_ENABLED 0x01010002
def zbDOOR_LOCK_NUMBER_OF_PIN_USERS 0x01010012
// --------

// Zwave lock types
def zwDOOR_LOCK_COMPONENTS_BOLT_MASK 0x02
def zwDOOR_LOCK_COMPONENTS_LATCH_MASK 0x04
def zwDOOR_LOCK_COMPONENTS_BOLT_LATCH_MASK 0x06

// ZigBee lock types
def zbDOOR_LOCK_COMPONENTS_BOLT_MASK 0x00
def zbDOOR_LOCK_COMPONENTS_LATCH_MASK 0x09
def zbDOOR_LOCK_COMPONENTS_BOLT_LATCH_MASK 0x05

// Zwave lock state
def zwDOOR_UNSECURE 0x00
def zwDOOR_UNSECURE_FOR_OUTSIDE 0x20
def zwDOOR_UNSECURE_FOR_OUTSIDE_TIMEOUT 0x21
def zwDOOR_SECURE 0xFF
def zwDOOR_STATE_UNKNOWN 0xFE

// Zigbee lock state
def zbDOOR_NOT_FULLY_LOCKED 0x00
def zbDOOR_LOCKED 0x01
def zbDOOR_UNLOCKED 0x02
def zbDOOR_UNDEFINED 0xFF

scope 0 {

  r'zbDOOR_LOCK_NUMBER_OF_PIN_USERS = r'zwUSER_CODE_DATA.zwUSER_CODE_NUMBER_OF_USERS

  // Linking Zigbee Lock State to mapped ZWave Lock State
  r'zbDOOR_LOCK_CLUSTER_LOCK_STATE =
    if ( r'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE == zwDOOR_UNSECURE_FOR_OUTSIDE ) zbDOOR_NOT_FULLY_LOCKED
    if ( r'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE == zwDOOR_UNSECURE_FOR_OUTSIDE_TIMEOUT ) zbDOOR_NOT_FULLY_LOCKED
    if ( r'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE == zwDOOR_UNSECURE ) zbDOOR_UNLOCKED
    if ( r'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE == zwDOOR_SECURE ) zbDOOR_LOCKED
    if ( r'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE == zwDOOR_STATE_UNKNOWN ) zbDOOR_UNDEFINED
    undefined

  // Assigning Zibee attribute Actuator enabled to static value 0xFF (Always on) (Hacked way of setting a constant)
  r'zbDOOR_LOCK_ACTUATOR_ENABLED = if( e'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE ) 0xFF undefined

  // Linking the desired Door State (MQTT) to ZWave
  d'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE =
    if ( d'zbDOOR_LOCK_CLUSTER_LOCK_STATE == zbDOOR_NOT_FULLY_LOCKED ) zwDOOR_UNSECURE_FOR_OUTSIDE
    if ( d'zbDOOR_LOCK_CLUSTER_LOCK_STATE == zbDOOR_LOCKED ) zwDOOR_SECURE
    if ( d'zbDOOR_LOCK_CLUSTER_LOCK_STATE == zbDOOR_UNLOCKED ) zwDOOR_UNSECURE
    if ( d'zbDOOR_LOCK_CLUSTER_LOCK_STATE == zbDOOR_UNDEFINED ) zwDOOR_STATE_UNKNOWN
    undefined

  // Linking Zigbee locktype to mapped ZWave lock type
  r'zbDOOR_LOCK_CLUSTER_LOCK_TYPE =
    if ( r'zwDOOR_LOCK_CAPABILITIES_SUPPORTED_DOOR_COMPONENTS == zwDOOR_LOCK_COMPONENTS_BOLT_MASK ) zbDOOR_LOCK_COMPONENTS_BOLT_MASK
    if ( r'zwDOOR_LOCK_CAPABILITIES_SUPPORTED_DOOR_COMPONENTS == zwDOOR_LOCK_COMPONENTS_LATCH_MASK ) zbDOOR_LOCK_COMPONENTS_LATCH_MASK
    if ( r'zwDOOR_LOCK_CAPABILITIES_SUPPORTED_DOOR_COMPONENTS == zwDOOR_LOCK_COMPONENTS_BOLT_LATCH_MASK ) zbDOOR_LOCK_COMPONENTS_BOLT_LATCH_MASK
    // If the device support version 4, here will map the z-wave ro zigbee doorlock type
    if (e'zwDOOR_LOCK_OPERATION_DOOR_LOCK_MODE) zbDOOR_LOCK_COMPONENTS_BOLT_MASK
    undefined // if the device support version 2, we hardcoded the doorlock type to bolt
}
