<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="524px" preserveAspectRatio="none" style="width:1333px;height:524px;background:#FFFFFF;" version="1.1" viewBox="0 0 1333 524" width="1333px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ens9a88ov3pk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFE0" height="512.4998" style="stroke:#A80036;stroke-width:1.0;" width="88" x="1" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82" x="4" y="18.077">MQTT Broker</text><rect fill="#ADD8E6" height="512.4998" style="stroke:#A80036;stroke-width:1.0;" width="1111.5" x="215.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26" x="758.25" y="18.077">ZPC</text><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="44.5" y1="61.3999" y2="170.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="44.5" x2="44.5" y1="170.2" y2="211.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="44.5" y1="211.3999" y2="327.7499"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="44.5" x2="44.5" y1="327.7499" y2="368.9498"/><line style="stroke:#A80036;stroke-width:1.0;" x1="44.5" x2="44.5" y1="368.9498" y2="479.6999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262.5" x2="262.5" y1="61.3999" y2="170.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="262.5" x2="262.5" y1="170.2" y2="211.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262.5" x2="262.5" y1="211.3999" y2="327.7499"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="262.5" x2="262.5" y1="327.7499" y2="368.9498"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262.5" x2="262.5" y1="368.9498" y2="479.6999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1270" x2="1270" y1="61.3999" y2="170.2"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1270" x2="1270" y1="170.2" y2="211.3999"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1270" x2="1270" y1="211.3999" y2="327.7499"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1270" x2="1270" y1="327.7499" y2="368.9498"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1270" x2="1270" y1="368.9498" y2="479.6999"/><rect fill="#FEFECE" filter="url(#f1ens9a88ov3pk)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="55" x="15.5" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="22.5" y="45.606">MQTT</text><rect fill="#FEFECE" filter="url(#f1ens9a88ov3pk)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="55" x="15.5" y="478.6999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="22.5" y="498.7058">MQTT</text><rect fill="#FEFECE" filter="url(#f1ens9a88ov3pk)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="82" x="219.5" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="226.5" y="45.606">StateTopic</text><rect fill="#FEFECE" filter="url(#f1ens9a88ov3pk)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="82" x="219.5" y="478.6999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="226.5" y="498.7058">StateTopic</text><rect fill="#FEFECE" filter="url(#f1ens9a88ov3pk)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="101" x="1218" y="25.6"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="1225" y="45.606">AttributeStore</text><rect fill="#FEFECE" filter="url(#f1ens9a88ov3pk)" height="30.7999" style="stroke:#A80036;stroke-width:1.5;" width="101" x="1218" y="478.6999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="1225" y="498.7058">AttributeStore</text><path d="M217,76.3999 L217,101.3999 L1315,101.3999 L1315,86.3999 L1305,76.3999 L217,76.3999 " fill="#FBFB77" filter="url(#f1ens9a88ov3pk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1305,76.3999 L1305,86.3999 L1315,86.3999 L1305,76.3999 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="750.75" y="93.477">Init</text><polygon fill="#A80036" points="1258.5,128.6,1268.5,132.6,1258.5,136.6,1262.5,132.6" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262.5" x2="1264.5" y1="132.6" y2="132.6"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="501" x="269.5" y="127.077">attribute_store_register_callback_by_type(att_store_node_cb, ATTRIBUTE_NODE_ID)</text><polygon fill="#A80036" points="1258.5,158.2,1268.5,162.2,1258.5,166.2,1262.5,162.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262.5" x2="1264.5" y1="162.2" y2="162.2"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="984" x="269.5" y="156.677">attribute_store_register_callback_by_type_and_state(att_store_network_status_cb, DOTDOT_ATTRIBUTE_ID_STATE_NETWORK_STATUS, REPORTED_ATTRIBUTE)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="659.25" y="194.4189"/><path d="M217,216.3999 L217,241.3999 L1315,241.3999 L1315,226.3999 L1305,216.3999 L217,216.3999 " fill="#FBFB77" filter="url(#f1ens9a88ov3pk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1305,216.3999 L1305,226.3999 L1315,226.3999 L1305,216.3999 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="581" x="469.25" y="233.4769">NETWORK_STATUS updated (ZCL_NODE_STATE_NETWORK_STATUS_ONLINE_FUNCTIONAL)</text><polygon fill="#A80036" points="273.5,268.5999,263.5,272.5999,273.5,276.5999,269.5,272.5999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="267.5" x2="1269.5" y1="272.5999" y2="272.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="450" x="279.5" y="267.0769">att_store_network_status_cb(NETWORK_STATUS, ATTRIBUTE_UPDATED)</text><polygon fill="#A80036" points="56,315.7499,46,319.7499,56,323.7499,52,319.7499" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50" x2="261.5" y1="319.7499" y2="319.7499"/><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="173" x="62" y="298.8999">ucl/by-unid/&lt;new-node&gt;/State</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="62" y="314.2269">{"NetworkState": "Included", ...}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="659.25" y="351.9689"/><path d="M217,373.9498 L217,398.9498 L1315,398.9498 L1315,383.9498 L1305,373.9498 L217,373.9498 " fill="#FBFB77" filter="url(#f1ens9a88ov3pk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1305,373.9498 L1305,383.9498 L1315,383.9498 L1305,373.9498 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="718.75" y="391.0269">Remove Node</text><polygon fill="#A80036" points="273.5,426.1499,263.5,430.1499,273.5,434.1499,269.5,430.1499" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="267.5" x2="1269.5" y1="430.1499" y2="430.1499"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="279.5" y="424.6269">att_store_node_cb(node_id, ATTRIBUTE_DELETED)</text><polygon fill="#A80036" points="56,457.6999,46,461.6999,56,465.6999,52,461.6999" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="50" x2="261.5" y1="461.6999" y2="461.6999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="62" y="456.1769">delete</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="138" x="101" y="456.4499">ucl/by-unid/&lt;new-node&gt;</text><!--MD5=[6a03dc2d55120705146fbec55629776e]
@startuml inline_umlgraph_5.svg
  box "MQTT Broker" #LightYellow
  participant MQTT
  end box

  box "ZPC" #LightBlue
  participant StateTopic
  participant AttributeStore
  end box
  note over StateTopic,AttributeStore: Init
  StateTopic          -> AttributeStore       : attribute_store_register_callback_by_type(att_store_node_cb, ATTRIBUTE_NODE_ID)
  StateTopic          -> AttributeStore       : attribute_store_register_callback_by_type_and_state(att_store_network_status_cb, DOTDOT_ATTRIBUTE_ID_STATE_NETWORK_STATUS, REPORTED_ATTRIBUTE)
  ... ...
  note over StateTopic,AttributeStore: NETWORK_STATUS updated (ZCL_NODE_STATE_NETWORK_STATUS_ONLINE_FUNCTIONAL)
  AttributeStore      -> StateTopic           : att_store_network_status_cb(NETWORK_STATUS, ATTRIBUTE_UPDATED)
  StateTopic          -> MQTT                 : <i>ucl/by-unid/<new-node>/State</i>\n{"NetworkState": "Included", ...}
  ... ...
  note over StateTopic,AttributeStore: Remove Node
  AttributeStore      -> StateTopic           : att_store_node_cb(node_id, ATTRIBUTE_DELETED)
  StateTopic          -> MQTT                 : delete <i>ucl/by-unid/<new-node></i>
@enduml

PlantUML version 1.2022.0(Tue Jan 11 16:16:42 UTC 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>