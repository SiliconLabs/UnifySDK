<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unify Coding Standard &mdash; Unify Host SDK</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom_styles.css" type="text/css" />
    <link rel="canonical" href="https://siliconlabs.github.io/UnifySDK/doc/standards/coding-standard.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/js/charenc.js"></script>
        <script src="../../_static/js/crypt.js"></script>
        <script src="../../_static/js/sha1.js"></script>
        <script src="../../_static/js/html5-qrcode.min.js"></script>
        <script src="../../_static/js/qr_code_scanner.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API documentation" href="../api.html" />
    <link rel="prev" title="Unify Library Overview" href="../unify_library_overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../introduction.html" class="icon icon-home"> Unify
            <img src="../../_static/silicon-labs-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                ver_1.7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Unify Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started_unify.html">Getting Started with Unify</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../UnifySDK.html">Unify Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unify_framework_services.html">Framework Services</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../protocol_controllers.html">Protocol Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unify_iot_services.html">IoT Services</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../getting_started_as_developer.html">Getting Started as a Developer</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../readme_developer.html">Unify Developer Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../readme_building.html">Unify Build Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme_cmake.html">CMake Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme_rust.html">Unify Rust Development</a></li>
<li class="toctree-l3"><a class="reference internal" href="../unify_library_overview.html">Unify Library Overview</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Unify Coding Standard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">1 Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#general-guidelines">2 General Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c-specific-guidelines">3 C Specific Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#coding-style-and-formatting">4 Coding style and formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documentation">5 Documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#doxygen-coding-style-guide">6 Doxygen Coding Style Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="#licensing">7 Licensing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">8 C++ Specific Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api.html">API documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme_developer.html#directory-structure-and-file-naming-conventions">Directory Structure and File Naming Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme_developer.html#clang-format-autoformat-code">Clang-Format (autoformat code)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme_developer.html#pre-commit-hooks">Pre-commit Hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme_developer.html#creating-a-new-application">Creating a New Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme_developer.html#unify-framework-library-unify-main-and-ipc">Unify Framework Library (Unify Main) and IPC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started_as_developer.html#development-platform-recommendations">Development Platform Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started_as_developer.html#developing-iot-services">Developing IoT Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started_as_developer.html#developing-eed">Developing EED</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started_as_developer.html#developing-protocol-controllers">Developing protocol controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started_as_developer.html#extend-ucl-clusters-to-non-zigbee-controllers">Extend UCL clusters to non-zigbee controllers</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../unify_specifications/index.html">Unify Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system_requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="known-abbreviations.html">Known Abbreviations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../introduction.html">Unify</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <script>
    $(".wy-side-scroll").append("<div class='github-button'><iframe src='https://ghbtns.com/github-btn.html?user=SiliconLabs&repo=UnifySDK&type=watch&count=true&size=large&v=2' allowtransparency='true' frameborder='0' scrolling='0' width='170' height='30'></iframe></div>");
</script>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="unify-coding-standard">
<h1>Unify Coding Standard<a class="headerlink" href="#unify-coding-standard" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>1 Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<section id="purpose-of-this-document">
<h3>1.1 Purpose of this document<a class="headerlink" href="#purpose-of-this-document" title="Permalink to this heading"></a></h3>
<p>The purpose of this document is to describe the coding standard used by the
components of the Unify Host SDK. It is a modified version of the standard for
Silicon Labs MCU customer facing firmware.</p>
<p>A unified coding standard is necessary to provide a professional look &amp; feel in
the source code that we provide to our customers. Furthermore, it reduces
cognitive load, when you need to work with another group’s code. Coding style
and preferences differ from person to person, which means that there will be
rules in this document that you will disagree with. However, please adhere to
the rules described here, as having a coding standard that you (somewhat)
disagree with is better than having no coding standard.</p>
</section>
<section id="structure-and-wording-of-this-document">
<h3>1.2 Structure and wording of this document<a class="headerlink" href="#structure-and-wording-of-this-document" title="Permalink to this heading"></a></h3>
<p>This document contains three separate parts: Coding guidelines, coding style and
documentation. The coding guidelines deal with the structure of your code. This
part is split into a general and a C specific part. The coding style guide
details how your code should look, e.g. brace style, comment style etc.
Documentation deals with how you should document your code to make it easy for
other people to use and modify the code.</p>
<section id="source-code">
<h4>1.2.1 Source Code<a class="headerlink" href="#source-code" title="Permalink to this heading"></a></h4>
<p>In this document, <strong>Source code</strong> is used as a common name for any C, C++ or
header file from Silicon Labs that is being provided to customers. It applies to
both manually created as well as autogenerated code.</p>
</section>
<section id="required">
<h4>1.2.2 Required<a class="headerlink" href="#required" title="Permalink to this heading"></a></h4>
<p>Some of the coding standards are required and some are recommendations. All
required coding standards are tagged with <strong>Required</strong>.</p>
</section>
<section id="recommended">
<h4>1.2.3 Recommended<a class="headerlink" href="#recommended" title="Permalink to this heading"></a></h4>
<p>Recommended rules should generally be followed. However, recommended rules can
be broken in special circumstances. All recommended coding standards are tagged
<strong>Recommended</strong>.</p>
</section>
<section id="should">
<h4>1.2.4 Should<a class="headerlink" href="#should" title="Permalink to this heading"></a></h4>
<p>The word “should” is used throughout this document. In this context, “should” is
used to indicate best practice. You should strive to meet these guidelines.
However, it is possible to break these rules, if that results in a better end
result.</p>
</section>
</section>
<section id="application-of-this-standard">
<h3>1.3 Application of this standard<a class="headerlink" href="#application-of-this-standard" title="Permalink to this heading"></a></h3>
<section id="new-modules">
<h4>1.3.1 New modules<a class="headerlink" href="#new-modules" title="Permalink to this heading"></a></h4>
<p>This standard applies unconditionally to new modules.</p>
<p>Please note that a new software module does not need to be a new full stack.
This could be only a new part in an existing stack.</p>
</section>
<section id="existing-modules">
<h4>1.3.2 Existing modules<a class="headerlink" href="#existing-modules" title="Permalink to this heading"></a></h4>
<p>Existing components will continue to use the coding standard they are already
using (there is still some differences between the various stacks).</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="general-guidelines">
<h2>2 General Guidelines<a class="headerlink" href="#general-guidelines" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3>2.1 General Guidelines<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>We can’t put everything into these guidelines, for things not covered in the
guidelines, try to make your code blend in with the code you are editing. Use
your best judgment!</p>
<section id="use-peer-review">
<h4>2.1.1 Use peer review<a class="headerlink" href="#use-peer-review" title="Permalink to this heading"></a></h4>
<p>A coworker should review all code. In practice, pull requests are encouraged as
it allows people to comment on your work easily and it makes it possible to have
good discussions about specific lines of code.</p>
</section>
<section id="be-a-boy-scout">
<h4>2.1.3 Be a Boy Scout<a class="headerlink" href="#be-a-boy-scout" title="Permalink to this heading"></a></h4>
<p>Leave the source code in a better condition than you found it!</p>
</section>
<section id="avoid-reinventing-the-wheel">
<h4>2.1.4 Avoid reinventing the Wheel<a class="headerlink" href="#avoid-reinventing-the-wheel" title="Permalink to this heading"></a></h4>
<p>If somebody has implemented some functionality before, you should use that
rather than developing it again from scratch. This could be a function in a
standard library, or a module that was internally developed. Silicon Labs is a
large company with many different groups developing software for various use.
What you need might already exist! If the existing code doesn’t suit your needs
exactly but is close, consider whether the required changes would make it more
generally useful. If so, change it.</p>
</section>
<section id="refactor-code">
<h4>2.1.5 Refactor code<a class="headerlink" href="#refactor-code" title="Permalink to this heading"></a></h4>
<p>Try to refactor code instead of duplicating it. Extract common functionality
into functions, parameterize or abstract differences, etc.</p>
</section>
</section>
<section id="testing">
<h3>2.2 Testing<a class="headerlink" href="#testing" title="Permalink to this heading"></a></h3>
<section id="testability">
<h4>2.2.1 Testability<a class="headerlink" href="#testability" title="Permalink to this heading"></a></h4>
<p>Design the code in a modular fashion that allows functional testing. If
possible, create unit tests for your software.</p>
</section>
<section id="regression-test">
<h4>2.2.2 Regression Test<a class="headerlink" href="#regression-test" title="Permalink to this heading"></a></h4>
<p>It is encouraged to add a decent level of automated regression tests.</p>
</section>
</section>
<section id="embedded-coding">
<h3>2.3 Embedded Coding<a class="headerlink" href="#embedded-coding" title="Permalink to this heading"></a></h3>
<section id="write-energy-friendly-code">
<h4>2.3.1 Write energy friendly code<a class="headerlink" href="#write-energy-friendly-code" title="Permalink to this heading"></a></h4>
<p>The code should be energy friendly. This means taking advantage of hardware
features available and always going down to the lowest energy mode possible. Try
to always keep this in mind when writing energy aware code:</p>
<ul class="simple">
<li><p>Make sure all hardware modules or functions that are not needed by the
application are disabled or shut down as often as possible</p></li>
<li><p>Use DMA whenever possible and put the device in the lowest possible sleep mode</p></li>
<li><p>Faster code = more time to sleep</p></li>
<li><p>Avoid busy waiting unless absolutely necessary!</p></li>
<li><p>Remember: everything matters!</p></li>
<li><p>Energy aware code can get complicated and difficult to debug. That is why it
adds more value!</p></li>
<li><p>Use Simplicity Studio or similar tool to profile the energy usage of your
code. The results are often surprising.</p></li>
</ul>
</section>
<section id="interrupts">
<h4>2.3.2 Interrupts<a class="headerlink" href="#interrupts" title="Permalink to this heading"></a></h4>
<p>Interrupts shall have as minimal processing as possible. If possible it should
just send an event to a task for later processing. Having long interrupt
processing times might cause problems when other time-critical pieces of code
are blocked from executing (radio protocols being a prime example).</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="c-specific-guidelines">
<h2>3 C Specific Guidelines<a class="headerlink" href="#c-specific-guidelines" title="Permalink to this heading"></a></h2>
<section id="compilers">
<h3>3.1 Compilers<a class="headerlink" href="#compilers" title="Permalink to this heading"></a></h3>
<section id="c-standards-version-required">
<h4>3.1.1 C standards version (Required)<a class="headerlink" href="#c-standards-version-required" title="Permalink to this heading"></a></h4>
<p>Unify uses GNU99 (C99 with GNU Extensions).</p>
</section>
<section id="id2">
<h4>3.1.1.1 C++ standards version (Required)<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<p>Unify uses C++17 with GNU extensions.</p>
</section>
<section id="support-mixing-c-and-c-recommended">
<h4>3.1.2 Support mixing C++ and C (Recommended)<a class="headerlink" href="#support-mixing-c-and-c-recommended" title="Permalink to this heading"></a></h4>
<p>C++ is increasing in popularity. To make sure that our libraries and code are
compatible with C++ code, functions in header files should be defined inside an
<code class="docutils literal notranslate"><span class="pre">extern</span> <span class="pre">&quot;C&quot;</span></code> block. This makes it possible to call C functions from C++.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef __cplusplus
extern &quot;C&quot; {
#endif

void foo(void);

// other functions ...

#ifdef __cplusplus
}
#endif
</pre></div>
</div>
<blockquote>
<div><p><strong>Comment:</strong> Do not add an extra layer of indentation between the opening and
closing braces in this case. This is also an exception to the rule that
requires braces to be on line by themselves.</p>
</div></blockquote>
</section>
<section id="multiple-build-tool-support-recommended">
<h4>3.1.3 Multiple build tool support (Recommended)<a class="headerlink" href="#multiple-build-tool-support-recommended" title="Permalink to this heading"></a></h4>
<p>Not relevant for Unify.</p>
</section>
<section id="compile-with-warnings-required">
<h4>3.1.4 Compile with warnings (Required)<a class="headerlink" href="#compile-with-warnings-required" title="Permalink to this heading"></a></h4>
<p>Compiler warnings often indicate bugs that will only be seen at runtime and that
may be very difficult to find during testing.  For example, the compiler may
warn you about using an uninitialized variable.  This can be difficult to find
during testing.</p>
<p>Use the compiler option -Wall to enable all warnings.</p>
</section>
<section id="treat-warnings-as-errors-required">
<h4>3.1.5 Treat warnings as errors (Required)<a class="headerlink" href="#treat-warnings-as-errors-required" title="Permalink to this heading"></a></h4>
<p>Warnings should be treated as errors so that the build does not complete until
the warning if fixed.  Having a zero tolerance for warnings will help keep our
code cleaner and contain fewer bugs.</p>
<p>Use the compiler option -Werror to treat warnings as errors.  This applies to
builds that are part of “make test”.  It does not apply to build mechanisms
passed through to customer projects.</p>
<p>Exceptions to Werror have to be approved in code review and have their
rationale documented.  Exceptions should disable errors, but leave warning
intact (-wno-error=some-kind-of-warning) unless the warning is so noisy as flood
build output.  In that case it should be disabled entirely.
(-wno-some-kind-of-warning)</p>
</section>
</section>
<section id="preprocessor">
<h3>3.2 Preprocessor<a class="headerlink" href="#preprocessor" title="Permalink to this heading"></a></h3>
<section id="use-header-file-guards-required">
<h4>3.2.1 Use header file guards (Required)<a class="headerlink" href="#use-header-file-guards-required" title="Permalink to this heading"></a></h4>
<p>A header file guard must cover all header files unless they are intended to be
included multiple times from the same source file (which should be rare and
justified). The name of the guard is of the form:</p>
<p><em>upper case file name</em></p>
<p>where characters in the file name other than alphanumerics are replaced with
underscores and leading underscores are stripped. Guards should guard all other
code in the file except comment headers. In particular, they should guard
<code class="docutils literal notranslate"><span class="pre">extern</span></code> declarations and <code class="docutils literal notranslate"><span class="pre">#include</span></code> statements.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifndef MY_FILE_H
#define MY_FILE_H

#include &lt;stdint.h&gt;

extern volatile uint64_t jiffies;

// ...

#endif  // MY_FILE_H
</pre></div>
</div>
</section>
<section id="preprocessor-conditional-compilation-recommended">
<h4>3.2.2 Preprocessor conditional compilation (Recommended)<a class="headerlink" href="#preprocessor-conditional-compilation-recommended" title="Permalink to this heading"></a></h4>
<p>Limit the use of preprocessor conditional compile statements like <code class="docutils literal notranslate"><span class="pre">#if</span></code> and
<code class="docutils literal notranslate"><span class="pre">#ifdef</span></code>. If used, avoid using preprocessor conditions inside functions.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#if !defined(LINUX_DBG)
#define sl_enable_interrupts()   __restore_interrupt()
#define sl_disable_interrupts()  __disable_interrupt()
#else
#define sl_enable_interrupts()   (void)0
#define sl_disable_interrupts()  (void)0
#endif

void sl_do_something(void)
{
  sl_enable_interrupts();
  sl_do_atomic_operation();
  sl_disable_interrupts();
}
</pre></div>
</div>
<blockquote>
<div><p><strong>Comment</strong>: The above is a cleaner way to write code that in this example has
more than one way to enable/disable interrupts. Below is the original, not so
clean, code from the example above.</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sl_do_something(void)
{
#if !defined(LINUX_DBG)
  __disable_interrupt();
#endif
  sl_do_atomic_operation();
#ifndef LINUX_DBG
  __restore_interrupt();
#endif
}
</pre></div>
</div>
</section>
<section id="use-of-preprocessor-directive-error-recommended">
<h4>3.2.3 Use of preprocessor directive #error (Recommended)<a class="headerlink" href="#use-of-preprocessor-directive-error-recommended" title="Permalink to this heading"></a></h4>
<p>Use <code class="docutils literal notranslate"><span class="pre">#error</span></code> when <code class="docutils literal notranslate"><span class="pre">#defines</span></code> can only be set to certain values, or other
configuration problems.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#if (DEFAULT_SAMPLE_RATE8 == 44)
#define DEFAULT_SAMPLE_FREQ 44100
#elif (DEFAULT_SAMPLE_RATE8 == 48)
#define DEFAULT_SAMPLE_FREQ 48000
#else
#error Invalid value: DEFAULT_SAMPLE_RATE8
#endif
</pre></div>
</div>
</section>
<section id="use-of-preprocessor-directive-include-recommended">
<h4>3.2.4 Use of preprocessor directive #include (Recommended)<a class="headerlink" href="#use-of-preprocessor-directive-include-recommended" title="Permalink to this heading"></a></h4>
<p>Header files should generally list their dependencies explicitly. The preferred
way is to <code class="docutils literal notranslate"><span class="pre">#include</span></code> prerequisite header files. Alternatively, the header file
may validate that an appropriate macro is defined.</p>
<p><strong>Preferred</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#include &quot;sl_foo.h&quot;

void sl_bar(sl_foo_t baz);     // sl_foo_t is defined in sl_foo.h
</pre></div>
</div>
<p><strong>Alternative</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// sl_foo_t is defined in sl_foo.h
#ifndef FOO_T_DEFINED
#error This source file needs to #include sl_foo.h
#endif

void sl_bar(sl_foo_t baz);     // sl_foo_t is defined in sl_foo.h
</pre></div>
</div>
<p>You should strive to not include more header files than you really require in a
given C file. Having more than you need increases compilation time and increases
the chance of unintended side effects. <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> are used by the compiler to
change the search path for included files. In general, <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code> should only be used
for C standard libraries. <code class="docutils literal notranslate"><span class="pre">#include</span></code> should generally not be used for C files.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#include &lt;stdlib.h&gt;
#include &quot;SI_C8051F850_Register_Enums.h&quot;
#include &quot;SI_Bluetooth_Init.h&quot;
</pre></div>
</div>
</section>
</section>
<section id="use-of-preprocessor-directive-undef-recommended">
<h3>3.2.5 Use of preprocessor directive <code class="docutils literal notranslate"><span class="pre">#undef</span></code> (Recommended)<a class="headerlink" href="#use-of-preprocessor-directive-undef-recommended" title="Permalink to this heading"></a></h3>
<p>Using <code class="docutils literal notranslate"><span class="pre">#undef</span></code> should be avoided as it can lead to weird behaviors that are
often fairly difficult to detect and solve. For example, errors can occur only
when compiling files in a certain order.</p>
</section>
<section id="use-of-preprocessor-stringify-and-concatenation-recommended">
<h3>3.2.6 Use of preprocessor ‘stringify’ and concatenation (Recommended)<a class="headerlink" href="#use-of-preprocessor-stringify-and-concatenation-recommended" title="Permalink to this heading"></a></h3>
<p>Use of the preprocessor ‘stringify’ or string concatenation operations should
be avoided or kept to a minimum. Manipulations such as these can quickly become
quite complex to understand, maintain or debug and should be avoided whenever
possible.</p>
</section>
<section id="general-use-of-preprocessor-recommended">
<h3>3.2.7 General use of preprocessor  (Recommended)<a class="headerlink" href="#general-use-of-preprocessor-recommended" title="Permalink to this heading"></a></h3>
<p>The preprocessor should be used reasonably, mostly for usual operations such as
doing conditional compilation including that described in section 3.2.2,
including files, reporting an error, etc. Using the preprocessor to do complex
or unusual operations should normally be avoided.</p>
</section>
<section id="standard-libraries">
<h3>3.3 Standard Libraries<a class="headerlink" href="#standard-libraries" title="Permalink to this heading"></a></h3>
<section id="use-of-stdint-h-and-stdbool-h-required">
<h4>3.3.1 Use of stdint.h and stdbool.h (Required)<a class="headerlink" href="#use-of-stdint-h-and-stdbool-h-required" title="Permalink to this heading"></a></h4>
<p>Use <code class="docutils literal notranslate"><span class="pre">stdint.h</span></code> and <code class="docutils literal notranslate"><span class="pre">stdbool.h</span></code> types whenever possible. This makes types
unambiguous, more portable and opens up compiler optimizations.</p>
<p>This means that you should always use C99 types like <code class="docutils literal notranslate"><span class="pre">uint8_t</span></code>. Do not use other
types such as <code class="docutils literal notranslate"><span class="pre">U8</span></code> or <code class="docutils literal notranslate"><span class="pre">UINT8</span></code> unless needed to maintain compatibility with older
code or third party library.</p>
</section>
<section id="use-of-stdlib-recommended">
<h4>3.3.2 Use of stdlib (Recommended)<a class="headerlink" href="#use-of-stdlib-recommended" title="Permalink to this heading"></a></h4>
<p>You can use the stdlib functions <em>memset</em>, <em>memcpy</em>, <em>memmove</em>, <em>memcmp</em>,
<em>strcmp</em>, etc. instead of writing your own for-loops. In code bases where these
functions have been abstracted (e.g., by MEMSET, MEMCMP, and friends in the base
repo), it is recommended to use those abstractions. Otherwise, for Cortex-M
class devices it is recommended to use the stdlib versions as they are often
heavily optimized.</p>
</section>
<section id="use-of-dynamic-memory-the-heap-recommended">
<h4>3.3.3 Use of dynamic memory / the heap (Recommended)<a class="headerlink" href="#use-of-dynamic-memory-the-heap-recommended" title="Permalink to this heading"></a></h4>
<p>Allowed, but should be kept to a minimum in Unify.</p>
<p>Dynamic memory allocation with <code class="docutils literal notranslate"><span class="pre">malloc()</span></code> and <code class="docutils literal notranslate"><span class="pre">free()</span></code> should generally not be
used. Some of our customers have strict rules in their QA procedures that
dictate that malloc() cannot be used in embedded software. If we use it, then
our libraries become unusable for them. The problem with malloc()/free() is
fragmentation. Because our micros are memory constrained and have no virtual
memory, malloc() can over time fragment memory, which in turn can cause a
malloc() to fail down the road.</p>
</section>
<section id="do-not-use-the-standard-c-assert-required">
<h4>3.3.4 Do not use the standard C assert() (Required)<a class="headerlink" href="#do-not-use-the-standard-c-assert-required" title="Permalink to this heading"></a></h4>
<p>It is strongly recommended to not use the assert() function that comes with the
standard C/C++ library. If the Silicon Labs libraries used in your project
contains assert function(s), then use them. If no Silicon Labs specific assert
function is available, then use the code from the example below. The rationale
for this rule is that a number of toolchains will bring in their standard
library versions of printf and friends in order to implement assert. This can
bring in unwanted side effects, such as code size increases.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// void user_assert (int file, int line);                   /* declaration */
// #define USER_ASSERT(file, line) user_assert(file, line)  /* definition  */

void sl_assert(const char *file, int line)
{
  (void)file;  // Unused parameter
  (void)line;  // Unused parameter
  // Wait forever until the watchdog fires
  while (1);
}

#if defined(NDEBUG)
#define SL_ASSERT(expr)
#else
#if defined(USER_ASSERT)
#define SL_ASSERT(expr)   ((expr) ? ((void)0) : USER_ASSERT(__FILE__, __LINE__))
#else
#define SL_ASSERT(expr)   ((expr) ? ((void)0) : sl_assert(__FILE__, __LINE__))
#endif
#endif
</pre></div>
</div>
<blockquote>
<div><p><strong>Comment:</strong> Below are the steps to overwrite Silicon Labs assert function
with a user defined assert.</p>
<ol class="arabic simple">
<li><p>define a <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">user_assert(const</span> <span class="pre">char</span> <span class="pre">*,</span> <span class="pre">int)</span></code> function</p></li>
<li><p>Uncomment the two lines in the above example (marked “declaration” and “definition”).</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">assert()</span></code> is a void function and never return any value. If you like
a function to return a value depending on the evaluation of an expression,
then feel free to create a new function for that purpose.</p>
</div></blockquote>
</section>
</section>
<section id="keywords">
<h3>3.4 Keywords<a class="headerlink" href="#keywords" title="Permalink to this heading"></a></h3>
<section id="the-volatile-keyword-recommended">
<h4>3.4.1 The “volatile” keyword (Recommended)<a class="headerlink" href="#the-volatile-keyword-recommended" title="Permalink to this heading"></a></h4>
<p>Not relevant in Unify. We expect no or very few volatile variables.</p>
</section>
<section id="the-inline-keyword-recommended">
<h4>3.4.2 The “inline” keyword (Recommended)<a class="headerlink" href="#the-inline-keyword-recommended" title="Permalink to this heading"></a></h4>
<p>Not relevant to Unify.</p>
</section>
<section id="the-static-keyword-required">
<h4>3.4.3 The “static” keyword (Required)<a class="headerlink" href="#the-static-keyword-required" title="Permalink to this heading"></a></h4>
<p>For file global variables (variables that are global to a file but not visible
outside the file) should always use the <code class="docutils literal notranslate"><span class="pre">static</span></code> keyword. This should also apply
to any functions that are used only within a single file.</p>
<p>Keep in mind the difference between a static variable at the file scope level,
and a static variable declared within a function.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// A variable that is only visible within a file
static uint32_t my_local_variable = 0xFF;

// A function that is used only within a file
static void do_something(void)
{
  // ...
}
</pre></div>
</div>
<p>For Cortex-Mx devices, use the CMSIS <code class="docutils literal notranslate"><span class="pre">__STATIC_INLINE</span></code> macro if you need
something to be both static and inline.</p>
</section>
</section>
<section id="data-types">
<h3>3.5 Data Types<a class="headerlink" href="#data-types" title="Permalink to this heading"></a></h3>
<section id="avoid-enums-in-arrays-structures-or-unions-required">
<h4>3.5.1 Avoid enums in arrays, structures, or unions (Required)<a class="headerlink" href="#avoid-enums-in-arrays-structures-or-unions-required" title="Permalink to this heading"></a></h4>
<p>Not used in Unify. The full source is shared with customers, so there is no
toolchain mismatch. Serialized format must be decoupled from the in-memory
representation anyway, so this will not affect the persistent data formats.</p>
</section>
<section id="avoid-bitfields-in-structures-unions-required">
<h4>3.5.2 Avoid bitfields in structures/unions (Required)<a class="headerlink" href="#avoid-bitfields-in-structures-unions-required" title="Permalink to this heading"></a></h4>
<p>Also relevant for Unify, for two reasons: 1) Bitfields cannot be used for wire
formats, because the bit-layout is compiler-implemnentation defined; by
disallowing it we prevent this type of mistakes. And 2) for performance reasons:
Bitfields are typically slower to manipulate, and we are not trying to optimize
the Unify Host SDK for memory size.</p>
<p>This is also especially important for aggregate types shared between libraries
and customer-compiled code. As with enums, the size and bit layout of bitfields
is not standardized, but is compiler-defined or subject to compiler options.
Libraries built with one compiler or options will not interface properly to
non-library code built with a different compiler or options.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// sl_lib.h include file:

typedef struct {
  bool    ena          : 1;
  uint8_t some_setting : 5;
} sl_lib_struct_t;

// Library could be built such that this structure is laid out in a byte:
//   7   6   5   4   3   2   1   0
// [ x | x |     some_setting  |ena]
// while application could be built such that this structure is laid out
// across two bytes, or in different endian order:
//   7   6   5   4   3   2   1   0
// [ena| x | x | x | x | x | x | x ]
// [   some_setting    | x | x | x ]
</pre></div>
</div>
</section>
</section>
<section id="variables">
<h3>3.6 Variables<a class="headerlink" href="#variables" title="Permalink to this heading"></a></h3>
<section id="using-global-variables-recommended">
<h4>3.6.1 Using global variables (Recommended)<a class="headerlink" href="#using-global-variables-recommended" title="Permalink to this heading"></a></h4>
<p>Minimize use of global variables. It is hard for a compiler to optimize code
using them. The compiler (usually) only sees one C file at the time and does not
know if the global has been changed between accesses.</p>
<p>In Unify always prefer inter-component communications (events, API function calls
etc. over shared global variables). Global variables inside a component is
allowed.</p>
<p>A way around this might be to copy the global to a static/auto variable and use
the copy in your code.</p>
<p>Global variables can also easily become a source for confusion and errors in the
application code as time goes on. As different developers work on the code they
might use the global in slightly different ways and accidentally break something
in parts of the code they are not working on. This recommendation should be
evaluated at an architecture/project level to determine if it applies.</p>
<blockquote>
<div><p><strong>8051 Note:</strong> The 8051 compiler will often produce more efficient code when
using a project global instead of sharing global data through a handle pointer
or other mechanism. This trade-off should be taken into account when writing
code targeted for 8051. As much as possible, steps should still be taken to
minimize the use of global variables.</p>
</div></blockquote>
</section>
</section>
<section id="functions">
<h3>3.7 Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h3>
<section id="prototype-functions-required">
<h4>3.7.1 Prototype functions (Required)<a class="headerlink" href="#prototype-functions-required" title="Permalink to this heading"></a></h4>
<p>Make sure either the full implementation or a prototype precedes any call to a
function. For external functions, this should be done by with a <code class="docutils literal notranslate"><span class="pre">#include</span></code> of
the appropriate header.</p>
</section>
<section id="functions-return-data-types-required">
<h4>3.7.2 Functions return data types (Required)<a class="headerlink" href="#functions-return-data-types-required" title="Permalink to this heading"></a></h4>
<p>All <strong>public and private functions</strong> that can fail should return either:</p>
<ol class="arabic simple">
<li><p>In case the possible outcomes is binary SUCCESS or FAILURE use
<code class="docutils literal notranslate"><span class="pre">sl_status_t</span></code>. The idea is to be as consistent and predictable throughout
all of our code base to make it easier for customers to know what to expect
from our functions.</p></li>
<li><p>In case of multiple error outcomes, define an enum with the with the
possible error and success values and return that. The enum should have its
own Doxygen and be linked from the function Doxygen.</p></li>
</ol>
<section id="exceptions">
<h5>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this heading"></a></h5>
<p>There will be functions that will not return <code class="docutils literal notranslate"><span class="pre">sl_status_t</span></code>or a function specific
error enum. For example, functions returning <code class="docutils literal notranslate"><span class="pre">void</span></code>; simple “getter” functions
that cannot fail or that we don’t need to differentiate between error cases; a
function checking if a condition is true or false could return a <code class="docutils literal notranslate"><span class="pre">bool</span></code>; a
function adding data to a string or buffer could return the number of bytes
added to the string or buffer; or a callback function could return an indicator
to let the stack know how to act. Other examples may exist but all of these
exceptions should be used sparingly and with good reason. Please check with your
team and/or manager before doing so.</p>
<p>In any case, the following requirements must be complied with:</p>
<ul class="simple">
<li><p>if a function can fail, there must be a clear indication as to how to detect
a failure. This is preferrably done through returning <code class="docutils literal notranslate"><span class="pre">sl_status</span></code>or a function
specific error enum, but having a special ‘invalid’ value returned in case of
failure is also allowed. No matter
how this is achieved, it must be documented in the doxygen function header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> must not be returned to indicate success or failure. <code class="docutils literal notranslate"><span class="pre">bool</span></code> should
only be used to indicate if a given condition is true or false. Even then,
using an <code class="docutils literal notranslate"><span class="pre">enum</span></code> should be considered for future-proofing the function, should
it need to return more than a true/false value in the future.</p></li>
</ul>
</section>
</section>
<section id="return-values-should-always-be-checked-and-propagated-recommended">
<h4>3.7.3 Return values should always be checked and propagated (Recommended)<a class="headerlink" href="#return-values-should-always-be-checked-and-propagated-recommended" title="Permalink to this heading"></a></h4>
<p>Values returned by any function should always be checked to see if an error
occurred. Such return values should normally be propagated up the callers tree
up to the application or to a function that can react to it.</p>
</section>
<section id="functions-replicating-a-standard-api-can-follow-that-api-recommended">
<h4>3.7.4 Functions replicating a standard API can follow that API (Recommended)<a class="headerlink" href="#functions-replicating-a-standard-api-can-follow-that-api-recommended" title="Permalink to this heading"></a></h4>
<p>If a function aims to replicate a standard API (like <code class="docutils literal notranslate"><span class="pre">strcpy</span></code> or <code class="docutils literal notranslate"><span class="pre">printf</span></code>), our
version of the function can replicate that standard function’s API. These
functions do not need to follow our coding standards’ directives relating to
data types, return values or status. It should still follow our naming
convention.</p>
</section>
</section>
<section id="macros">
<h3>3.8 Macros<a class="headerlink" href="#macros" title="Permalink to this heading"></a></h3>
<section id="macros-with-side-effects-recommended">
<h4>3.8.1 Macros with side-effects (Recommended)<a class="headerlink" href="#macros-with-side-effects-recommended" title="Permalink to this heading"></a></h4>
<p>Macros that may have have side-effects should be function-like and named
appropriately.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define sl_lock()     do {__acquire_mutex(&amp;sl_top_level_mutex);} while(0)
#define sl_unlock()   do {__release_mutex(&amp;sl_top_level_mutex);} while(0)
</pre></div>
</div>
</section>
<section id="macros-with-statement-s-required">
<h4>3.8.2 Macros with statement(s) (Required)<a class="headerlink" href="#macros-with-statement-s-required" title="Permalink to this heading"></a></h4>
<p>If a macro expands into one or more full statements, make sure it consumes a
subsequent semicolon. Furthermore, multiple-statement macros must be wrapped in
a block. These rules ensure that the expanded macro will have the same syntax as
a non-compound statement. Otherwise, it may cause undesirable parsing if a
customer uses it without braces in a selection (<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(...)</span> <span class="pre">FOO();</span></code>) or iteration
(<code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">(...)</span> <span class="pre">FOO();</span></code>) statement.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define SL_FOO(x, y)          \
          do {                \
            ga = (x);         \
            gb = (y);         \
            gc = ga + gb;     \
          } while (0)

#define do_nothing()   (void)0

void sl_bar(int baz)
{
  if (baz) {
    SL_FOO(123, 321);
  } else {
    do_nothing();
  }
}
</pre></div>
</div>
</section>
<section id="functional-macros-with-argument-s-required">
<h4>3.8.3 Functional macros with argument(s) (Required)<a class="headerlink" href="#functional-macros-with-argument-s-required" title="Permalink to this heading"></a></h4>
<p>Uses of arguments within macros, and the macro body itself, if it is an
expression, should be wrapped in parentheses. This avoids problems stemming from
unintended precedence groupings. Arguments should be used only once if possible
to avoid problems when a statement or expression with side effects is passed.</p>
<p><strong>Note:</strong> In general, static inline functions are preferred to macros as they
have less weird side-effects and are easier to read.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define sl_bar(x, y, z) (0xFFFF | ((x) &amp; ((y) | (z))))
</pre></div>
</div>
</section>
</section>
<section id="goto-statements">
<h3>3.9 goto statements<a class="headerlink" href="#goto-statements" title="Permalink to this heading"></a></h3>
<section id="goto-statements-should-only-be-used-for-cleanup-purposes-or-early-exit-in-case-of-an-error-when-there-is-no-simple-workaround-required">
<h4>3.9.1 <code class="docutils literal notranslate"><span class="pre">goto</span></code> statements should only be used for cleanup purposes or early exit in case of an error, when there is no simple workaround (Required)<a class="headerlink" href="#goto-statements-should-only-be-used-for-cleanup-purposes-or-early-exit-in-case-of-an-error-when-there-is-no-simple-workaround-required" title="Permalink to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">goto</span></code>s should never be used, except when needing to cleanup (free resources,
release a lock, exit a critical section, etc.) in the case an error occurred in
the function. If a simple workaround can be used instead of <code class="docutils literal notranslate"><span class="pre">goto</span></code>, the
workaround should be used instead.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Using goto, if no simple workaround available
void sli_usb_function(void)
{
  // Acquire lock
  // [...]
  if (!ok) {
    goto release;
  }
  // [...]
release:
  // Release lock
}

// Workaround, whenever possible
void sli_usb_function(void)
{
  // Acquire lock
  // [...]
  if (ok) {
    // [...]
  }
  // Release lock
}
</pre></div>
</div>
</section>
<section id="gotos-should-only-refer-to-a-label-declared-after-them-required">
<h4>3.9.2 <code class="docutils literal notranslate"><span class="pre">goto</span></code>s should only refer to a label declared after them (Required)<a class="headerlink" href="#gotos-should-only-refer-to-a-label-declared-after-them-required" title="Permalink to this heading"></a></h4>
<p>A <code class="docutils literal notranslate"><span class="pre">goto</span></code> statement should only refer to a label declared after (below) them, in
the code.</p>
<p>No <code class="docutils literal notranslate"><span class="pre">goto</span></code> shall ever cause the code to go back “up”, it should always jump
“down”, towards the end of the function.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Don&#39;t do:
void sli_usb_function(void)
{
  // [...]
loop_start:
  // [...]
  if (loop) {
    goto loop_start;
  }
}

// Instead do:
void sli_usb_function(void)
{
  // Acquire lock
  // [...]
  if (!ok) {
    goto release;
  }
  // [...]
release:
  // Release lock
}
</pre></div>
</div>
</section>
<section id="gotos-should-only-refer-to-a-static-label-located-in-the-same-function-required">
<h4>3.9.3 <code class="docutils literal notranslate"><span class="pre">goto</span></code>s should only refer to a static label located in the same function (Required)<a class="headerlink" href="#gotos-should-only-refer-to-a-static-label-located-in-the-same-function-required" title="Permalink to this heading"></a></h4>
<p>No computed <code class="docutils literal notranslate"><span class="pre">goto</span></code> statement (as available in some GCC extensions) shall be
used. <code class="docutils literal notranslate"><span class="pre">setjmp</span></code> and <code class="docutils literal notranslate"><span class="pre">longjmp</span></code> should never be used. The label referred to by a
<code class="docutils literal notranslate"><span class="pre">goto</span></code> statement needs to be in the same function as the goto statement itself.</p>
</section>
<section id="any-label-referenced-by-a-goto-need-to-be-declared-in-the-same-block-or-a-block-enclosing-the-goto-required">
<h4>3.9.4 Any label referenced by a <code class="docutils literal notranslate"><span class="pre">goto</span></code> need to be declared in the same block or a block enclosing the <code class="docutils literal notranslate"><span class="pre">goto</span></code> (Required)<a class="headerlink" href="#any-label-referenced-by-a-goto-need-to-be-declared-in-the-same-block-or-a-block-enclosing-the-goto-required" title="Permalink to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">goto</span></code> statements and labels should not be used to jump between blocks, as it
can easily lead to unstructured code. <code class="docutils literal notranslate"><span class="pre">goto</span></code> should not be used either to jump
between <code class="docutils literal notranslate"><span class="pre">case</span></code>s of a <code class="docutils literal notranslate"><span class="pre">switch</span></code>.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Don&#39;t do:
void sli_usb_function(uint8_t bar)
{
  if (bar &gt; 0) {
    goto label;
  }
  // [...]
  goto label;
  // [...]
  if (foo &gt; 0) {
label:
    // [...]
  }
}

// Instead do:
void sli_usb_function(uint8_t bar)
{
  // [...]
  goto label;
  // [...]
  if (bar &gt; 0) {
    goto label;
  }
  // [...]
label:
  // [...]
}

// Don&#39;t do:
void sli_usb_function(uint8_t bar)
{
  switch(bar) {
    case 1:
      if (x == y) {
        goto label;
      }
      break;

    case 2:
      doThat();
label:
      doTheOtherThing();
      break;

    default:
      break;
  }
}
</pre></div>
</div>
</section>
</section>
<section id="libraries">
<h3>3.10 Libraries<a class="headerlink" href="#libraries" title="Permalink to this heading"></a></h3>
<section id="dependencies-required">
<h4>3.10.1 Dependencies (Required)<a class="headerlink" href="#dependencies-required" title="Permalink to this heading"></a></h4>
<p>Be conscious about what code the library depends on. To avoid excessive code
footprint, we must be aware of what external functions each library pulls in.</p>
</section>
<section id="including-third-party-code-required">
<h4>3.10.2 Including third party code (Required)<a class="headerlink" href="#including-third-party-code-required" title="Permalink to this heading"></a></h4>
<p>For all open source or third party software that we include in our software
releases, we need to have an acceptable license that allows us to do so. That
means we need to send an email to our legal department (DL.Legal) and ask for
permission before introducing new open source software into our distributions.
Consult the Software Manager before including any third party software code
intended to be released.</p>
</section>
<section id="configuring-libraries-in-source-form-required">
<h4>3.10.3 Configuring libraries in source form (Required)<a class="headerlink" href="#configuring-libraries-in-source-form-required" title="Permalink to this heading"></a></h4>
<p>The customer should never have to change the original source files to configure
the library (this creates problems when upgrading the library to a newer
version, and also makes it impossible to have two projects with different
configuration settings using the same instance of the library). Instead, it
should be possible to set all configurations settings from the customer’s
application project. Normally this can be done with macros that allow a customer
to configure library settings from within the application.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#if !defined(EM_SETTING)                   // If EM_SETTING is not defined by user,
#define EM_SETTING default_value_for_em    // then we set our default value/function.
#endif
</pre></div>
</div>
</section>
<section id="configuring-libraries-in-binary-form-recommended">
<h4>3.10.4 Configuring libraries in binary form (Recommended)<a class="headerlink" href="#configuring-libraries-in-binary-form-recommended" title="Permalink to this heading"></a></h4>
<p>If a library is provided in binary form, then macros cannot be used for
configuration settings.</p>
<p>A good alternative is to use callback functions or static variables. Callbacks
might not be appropriate for 8-bit code, so use your judgment.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// We call sl_custom_configuration_callback() from our library to get the
// user defined configuration.
//
int configuration = sl_custom_configuration_callback();

// The user have to define sl_custom_configuration_callback() and return a
// valid configuration for the application.
//
int sl_custom_configuration_callback(void)
{
  return OPT_SIZE | MAX_BUF_SIZE;
}
</pre></div>
</div>
<blockquote>
<div><p><strong>Comment:</strong> sl_custom_configuration_callback is defined in user application
and returns different values depending on the user implementation.</p>
</div></blockquote>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// We initialize configuration with a sensible default that is suitable
// for the largest number of applications
//
int configuration = SL_DEFAULT_CONFIGURATION;

// The user application can customize the behavior by calling
// sl_set_configuration
//
void sl_set_configuration(int user_config)
{
  configuration = user_config;
}
</pre></div>
</div>
</section>
</section>
<section id="misc">
<h3>3.11 Misc<a class="headerlink" href="#misc" title="Permalink to this heading"></a></h3>
<section id="avoid-embedding-assignments-in-expressions-recommended">
<h4>3.11.1 Avoid embedding assignments in expressions (Recommended)<a class="headerlink" href="#avoid-embedding-assignments-in-expressions-recommended" title="Permalink to this heading"></a></h4>
<p>Embedding assignments in expressions makes for all kinds of wacky bugs. When
scanning some code it is easy to miss that a complicated expression contains an
assignment deep inside.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>++ceiling;
*handle = ceiling;
</pre></div>
</div>
<blockquote>
<div><p><strong>Comment:</strong> The above is easy to understand, hard to get wrong and most
compilers today will generate the same optimized code that that example as it
will for the below code;</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>*handle = ++ceiling;
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="coding-style-and-formatting">
<h2>4 Coding style and formatting<a class="headerlink" href="#coding-style-and-formatting" title="Permalink to this heading"></a></h2>
<section id="general-formatting">
<h3>4.1 General formatting<a class="headerlink" href="#general-formatting" title="Permalink to this heading"></a></h3>
<section id="use-spaces-not-tabs-required">
<h4>4.1.1 Use spaces, not tabs (Required)<a class="headerlink" href="#use-spaces-not-tabs-required" title="Permalink to this heading"></a></h4>
<p>For indenting files, use spaces and never tabs. A mix of tabs and spaces is
never acceptable.</p>
</section>
<section id="indents-are-2-spaces-per-level-required">
<h4>4.1.2 Indents are 2 spaces per level (Required)<a class="headerlink" href="#indents-are-2-spaces-per-level-required" title="Permalink to this heading"></a></h4>
<p>Indent each nested level with 2 spaces of indent.</p>
<section id="preprocessor-indentation-recommended">
<h5>4.1.2.1 Preprocessor indentation (Recommended)<a class="headerlink" href="#preprocessor-indentation-recommended" title="Permalink to this heading"></a></h5>
<p>Preprocessor directives historically have not been indented, but they may be
indented to make them less distracting to the module’s code flow (though the
technique described in the section 3.2.2 offers an even cleaner alternative
where it makes sense).  When indented, the # should remain attached to the
directive and not remain in the first column – no modern preprocessor still
requires the # be in the first column.  When an <code class="docutils literal notranslate"><span class="pre">#if</span></code> or <code class="docutils literal notranslate"><span class="pre">#ifdef</span></code> is indented,
its <code class="docutils literal notranslate"><span class="pre">#else</span></code>, <code class="docutils literal notranslate"><span class="pre">#elif</span></code>, and <code class="docutils literal notranslate"><span class="pre">#endif</span></code> shall also be identically indented.  The code
between the preprocessor directives may also be indented.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sl_set_xyz_option(xyz_option_t xyz_option)
{
  #if defined( _XYZ_LFCCLKEN0_MASK ) // XYZ supports LFC clock
    if (xyz_option == xyz_clock_lfc) {
      xyz_clock_set_lfc();
      return;
    }
  #endif
  #if defined( _XYZ_LFECLKSEL_MASK ) // XYZ supports LFE clock
    if (xyz_option == xyz_clock_lfe) {
      xyz_clock_set_lfe();
      return;
    }
  #endif
}
</pre></div>
</div>
</section>
</section>
<section id="lines-should-not-be-longer-than-80-characters-recommended">
<h4>4.1.3 Lines should not be longer than 80 characters (Recommended)<a class="headerlink" href="#lines-should-not-be-longer-than-80-characters-recommended" title="Permalink to this heading"></a></h4>
<p>We enforce an 80 characters limit per line of source code. This lets people set
up their editors such that they can have multiple editors side-by-side. Although
80 characters are little by modern standards, it mixes well with existing code.</p>
</section>
<section id="line-endings-required">
<h4>4.1.4 Line endings (Required)<a class="headerlink" href="#line-endings-required" title="Permalink to this heading"></a></h4>
<p>We use line ending normalization in our repositories. This means that all text
files are converted to ‘\n’ line endings when they are stored in git. However
most customers are using Windows operating system which expects a CRLF line
ending. Therefore, with rare exception, all source code delivered to customers
should have CRLF (DOS) line endings. There are two ways to accomplish this.
First, if you are using a Windows host operating system, set your git autocrlf
setting as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>core.autocrlf true
</pre></div>
</div>
<p>This will ensure all text files have DOS line endings when checked out from the
repository.</p>
<p>The second method is to use a release script that forces all text file line
endings to CRLF when a source code release package is built by the release
script.</p>
<blockquote>
<div><p><strong>Exceptions:</strong> if the source code is intended for a system that &gt;use normal
line endings, for example a OS X or Linux system, then &gt;the source line endings
can be left as ‘\n’.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Note:</strong> All repositories should include a .gitattributes file to explicitly
specify file types for line endings.</p>
</div></blockquote>
</section>
<section id="use-only-plain-ascii-or-utf-8-required">
<h4>4.1.5 Use only plain ASCII or UTF-8 (Required)<a class="headerlink" href="#use-only-plain-ascii-or-utf-8-required" title="Permalink to this heading"></a></h4>
<p>Text files should almost always contain only plain ASCII. Specifically, avoid
characters outside the usual whitespace and printable ones (0x9-0xD and
0x20-0x7E, inclusive). Internationalized strings, when used, are best placed in
a resource file.</p>
<p>In the rare case that other characters are needed in a text file and cannot be
escaped, the file should be UTF-8 encoded with no byte-order mark.</p>
</section>
<section id="use-iso8601-formatting-for-dates-required">
<h4>4.1.6 Use ISO8601 formatting for dates (Required)<a class="headerlink" href="#use-iso8601-formatting-for-dates-required" title="Permalink to this heading"></a></h4>
<p>If you use a date in the comments or elsewhere, specify it using the unambiguous
ISO8601 format, i.e. <code class="docutils literal notranslate"><span class="pre">2013-11-26</span></code>.</p>
</section>
<section id="inserting-empty-and-blank-lines-required">
<h4>4.1.7 Inserting empty and blank lines (Required)<a class="headerlink" href="#inserting-empty-and-blank-lines-required" title="Permalink to this heading"></a></h4>
<p>There should never be consecutive blank rows.</p>
<p>Use two slashes (C++ comment) and 77 dashes to separate logical parts of the
code. Use 2 slashes and 32 dashes for minor sections. Use of section separators
as shown here is optional.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// -----------------------------------------------------------------------------
// Here we start a new logical part in this source/header file...

// -------------------------------
// And here comes a new minor section...
</pre></div>
</div>
</section>
<section id="use-parentheses-liberally-required">
<h4>4.1.8 Use parentheses liberally (Required)<a class="headerlink" href="#use-parentheses-liberally-required" title="Permalink to this heading"></a></h4>
<p>Add parentheses if you have any doubt at all about precedence, not doing so has
led to some very obscure bugs. This is especially true of the bitwise binary
operators <code class="docutils literal notranslate"><span class="pre">{&amp;,</span> <span class="pre">|,</span> <span class="pre">^}</span></code> and Boolean operators <code class="docutils literal notranslate"><span class="pre">{&amp;&amp;,</span> <span class="pre">||}</span></code>.</p>
</section>
<section id="break-up-long-expressions-required">
<h4>4.1.9 Break up long expressions (Required)<a class="headerlink" href="#break-up-long-expressions-required" title="Permalink to this heading"></a></h4>
<p>Whenever there are long expressions, it should be broken into multiple lines.
When a line is broken into multiple lines, each line should start with the
operator that operates on that full line (single element or a group of elements
within parentheses). The operator must be the first thing on the line, and it
should be indented appropriately.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int bitmask = (OPTION_1
               | OPTION_2
               | (IS_THIS_SET
                  ? OPTION_3
                  : OPTION_4));

int bitmask = (OPTION_1
               | OPTION_2
               | (IS_THIS_SET ? OPTION_3 : OPTION_4));

int bitmask = (OPTION_1
               | OPTION_2
               | (OPTION_3 &amp; OPTION_4));
</pre></div>
</div>
<blockquote>
<div><p><strong>Comment:</strong> All the above are examples of nicely formatted long expressions.</p>
<p>Below is an example how you should not format long and complex expressions.</p>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Avoid this...
int no_good_formatting = (OPTION_1
                         | OPTION_2
                         | OPTION_3 &amp; OPTION_4);
</pre></div>
</div>
</section>
<section id="goto-labels-should-be-on-column-1-required">
<h4>4.1.10 <code class="docutils literal notranslate"><span class="pre">goto</span></code> labels should be on column 1 (Required)<a class="headerlink" href="#goto-labels-should-be-on-column-1-required" title="Permalink to this heading"></a></h4>
<p>Labels referred to by <code class="docutils literal notranslate"><span class="pre">goto</span></code>s need to be located at column 1, disregarding any
indentation.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Don&#39;t do:
void sli_usb_function(void)
{
  // Acquire lock
  // [...]
  if (!ok) {
    goto release;
  }
  // [...]
  release:
  // Release lock
}

// Instead do:
void sli_usb_function(void)
{
  // Acquire lock
  // [...]
  if (!ok) {
    goto release;
  }
  // [...]
release:
  // Release lock
}
</pre></div>
</div>
</section>
</section>
<section id="commenting-code-required">
<h3>4.2 Commenting code (Required)<a class="headerlink" href="#commenting-code-required" title="Permalink to this heading"></a></h3>
<section id="use-c-style-comments">
<h4>4.2.1 Use C++ style comments (“//”)<a class="headerlink" href="#use-c-style-comments" title="Permalink to this heading"></a></h4>
<p>All inline code comments should use the C++ style <code class="docutils literal notranslate"><span class="pre">//</span></code>. However there are two
exceptions to this rule. First, function and file documentation blocks use a
different style (see documentation section below).</p>
<p>Second, for multi-line macros using <code class="docutils literal notranslate"><span class="pre">#define</span></code>, C style comments <code class="docutils literal notranslate"><span class="pre">/*</span> <span class="pre">...</span> <span class="pre">*/</span></code>
should be used for embedded comments (see example below).</p>
<p>For both kinds of comments, there should be a space following the opening
comment marker. For example <code class="docutils literal notranslate"><span class="pre">//</span> <span class="pre">My</span> <span class="pre">comment</span></code>.</p>
<p>Make sure constant values in the code are explained. Function calls with raw
constants should be labeled based on the parameter that is being passed in.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Example for the exception
// This type is needed because using // would swallow the line continuation marker.
#define MY_CLI_COMMANDS \
  /* This command takes 3 arguments: */           \
  /*  Node ID - a 2-byte node ID destination */   \
  /*  Endpoint - a 1-byte node ID */              \
  /*  Cluster  - a 2-byte cluster ID */           \
  { &quot;my_command&quot;, my_command_function, &quot;vuv&quot; },

// Example of how to comment constant values.
// For the function declaration below
void function(int seconds, boolean print_output);

// we add comments after each parameter (OPTIONAL)
function(0,        // seconds
         FALSE);   // print_output
</pre></div>
</div>
</section>
</section>
<section id="bracing-style-required">
<h3>4.3 Bracing style (Required)<a class="headerlink" href="#bracing-style-required" title="Permalink to this heading"></a></h3>
<p>Use the so called “One True Brace Style” (see
[<a class="reference external" href="https://en.wikipedia.org/wiki/Indent_style#Variant:_1TBS">https://en.wikipedia.org/wiki/Indent_style#Variant:_1TBS</a>]) Indent
increases one level after an opening brace, and decreases one level before a
closing brace.  Opening braces do not go on their own separate line, except for
free standing blocks and function definitions.  Closing braces are on their own
separate line with nothing else on these lines.</p>
<p><strong>Clarification: The paragraph above takes precedence over the linked “One True
Brace Style” definition. In particular, opening braces must go on their own line
for function definitions even though this is a deviation from the linked “One
True Brace Style”.</strong></p>
<p><strong>All if/else/while/for/do-while blocks must be enclosed by braces, even if
there is only one statement in the block.</strong></p>
<p>Exceptions for the above rule are;</p>
<ol class="arabic simple">
<li><p>The typedef alias for a composite (<code class="docutils literal notranslate"><span class="pre">struct</span></code>/<code class="docutils literal notranslate"><span class="pre">union</span></code>) or <code class="docutils literal notranslate"><span class="pre">enum</span></code> type is on the
same line as the closing brace.</p></li>
<li><p>In a do-while loop the condition (<code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">(...);</span></code>) is on the same line as the
closing brace.</p></li>
<li><p>else and else if are on the same line as the closing brace.</p></li>
</ol>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sl_do_something(uint8_t bar)
{
  if (foo &gt; bar) { // The preceding brace is *required*
    do_this();
  } else if (for &lt; bar) {
    do_that();
  } else {
    do_another_thing();
  }

  if (foo &gt; bar) {
    do_this();
  }

  while (1) {
  }

  do {
    sli_do_work();
  } while (foo);
}

typedef enum {
  SL_CARD_SPADE,
  SL_CARD_HEART,
  SL_CARD_CLUB,
  SL_CARD_DIAMOND
} sl_card_suit_t;
</pre></div>
</div>
</section>
<section id="switch-statements-and-labels">
<h3>4.4 Switch statements and labels<a class="headerlink" href="#switch-statements-and-labels" title="Permalink to this heading"></a></h3>
<section id="using-labels-required">
<h4>4.4.1 Using labels (Required)<a class="headerlink" href="#using-labels-required" title="Permalink to this heading"></a></h4>
<p>Switch-case labels should be indented as any other line of code would be.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if (foo) {
  sl_bsp_set_leds(0xff00);

  testing:

  sl_bsp_set_leds(0x00ff);
}
</pre></div>
</div>
</section>
<section id="labels-with-block-required">
<h4>4.4.2 Labels with block (Required)<a class="headerlink" href="#labels-with-block-required" title="Permalink to this heading"></a></h4>
<p>If a block is desired after a label, then the opening brace should be by itself
on the line following the label, at the same indentation.</p>
<p>The closing brace should be on a line by itself after the last statement in the
block, at the same indent level as the opening brace.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if (foo) {
  sl_bsp_set_leds(0xff00);

  testing:
  {
    sl_bsp_set_leds(0x00ff);
    sl_bsp_set_leds(0x0000);
  }
}
</pre></div>
</div>
</section>
<section id="switch-statements-required">
<h4>4.4.3 Switch statements (Required)<a class="headerlink" href="#switch-statements-required" title="Permalink to this heading"></a></h4>
<p>The cases in switch statements should be indented one level from the enclosing
braces. Separate case blocks with a blank line after each <code class="docutils literal notranslate"><span class="pre">break;</span></code>. All switch
statements should include a <code class="docutils literal notranslate"><span class="pre">default</span></code> block unless there is a good reason not
to. The default block can collapse into one of the other cases but it should
clearly show what happens when there is no matching case. Finally, if a case
block does not end with an unconditional jump, there should be a comment clearly
stating that the code is intentionally meant to fall through.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>switch(baz) {
  case 1:
    sli_do_this();
    break;

  case 2:
    sli_do_that();
    // This case is meant to fall through to the next

  case 3: {
    sli_do_the_other_thing();
    break;
  }

  case 0:
  default:
    sli_do_what();
    break;
}
</pre></div>
</div>
</section>
</section>
<section id="functions-operators-and-c-keywords">
<h3>4.5 Functions, operators and C keywords<a class="headerlink" href="#functions-operators-and-c-keywords" title="Permalink to this heading"></a></h3>
<section id="listing-function-parameters-required">
<h4>4.5.1 Listing function parameters (Required)<a class="headerlink" href="#listing-function-parameters-required" title="Permalink to this heading"></a></h4>
<p>Whenever there is a list of function parameters, they should all fit on a single
line or be listed one parameter per line. If listed on separate lines, each
parameter has the same indent level as the first parameter.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sl_do_something(int a,
                     int b,
                     int c,
                     const char *string1,
                     const char *string2)
{
  // ...
}

void sl_do_something2(int a, int b, int c)
{
  // ...
}
</pre></div>
</div>
</section>
<section id="using-function-parentheses-required">
<h4>4.5.2 Using function parentheses (Required)<a class="headerlink" href="#using-function-parentheses-required" title="Permalink to this heading"></a></h4>
<p>For function declarations, definitions and calls, there shall be no spaces
before or after the opening parentheses, or before the closing parentheses.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>int sl_foo(int days, int seconds);
// ...
ret = sl_foo(days, seconds);
</pre></div>
</div>
</section>
<section id="binary-and-ternary-operators-required">
<h4>4.5.3 Binary and ternary operators (Required)<a class="headerlink" href="#binary-and-ternary-operators-required" title="Permalink to this heading"></a></h4>
<p>Use spaces around binary &amp; ternary operators in expressions. C expressions are
hard enough to parse without running them altogether.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for (j = 0; j &lt; parameter_sizes[i]; j++) {
</pre></div>
</div>
</section>
<section id="use-a-single-space-after-c-keywords-required">
<h4>4.5.4 Use a single space after C keywords (Required)<a class="headerlink" href="#use-a-single-space-after-c-keywords-required" title="Permalink to this heading"></a></h4>
<p>C keywords (ex. <code class="docutils literal notranslate"><span class="pre">for</span></code>, <code class="docutils literal notranslate"><span class="pre">switch</span></code>, <code class="docutils literal notranslate"><span class="pre">while</span></code>, <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">do</span></code>) – should have a single
space after the keyword.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>while (counter &lt; UART_MAX_IO_BUFFER) {
</pre></div>
</div>
</section>
<section id="additional-space-within-expressions">
<h4>4.5.5 Additional space within expressions<a class="headerlink" href="#additional-space-within-expressions" title="Permalink to this heading"></a></h4>
<p>Use of additional whitespace within expressions to improve readability
is permitted as long as it doesn’t interfere with appropriate multi-line
expression indentation.  Such style should be consistent within the module.</p>
</section>
<section id="identify-do-nothing-code-recommended">
<h4>4.5.6 Identify do-nothing code (Recommended)<a class="headerlink" href="#identify-do-nothing-code-recommended" title="Permalink to this heading"></a></h4>
<p>Avoid loops that do not make it obvious that they do nothing. Add a comment to
explain the reason for the do-nothing loop. This applies to any code that does
not do anything.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Don&#39;t do:
while (waiting_for_something);

// Instead do:
// Useful comment explaining why you are waiting
while (waiting_for_something);
</pre></div>
</div>
</section>
<section id="pointer-asterisk-position-required">
<h4>4.5.7 Pointer asterisk position (Required)<a class="headerlink" href="#pointer-asterisk-position-required" title="Permalink to this heading"></a></h4>
<p>When declaring a pointer to a variable, the pointer asterisk should be placed
together with the variable name, not together with the type.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Don&#39;t do:
char* c = (char*)a;
void sl_foo(uint32_t* bar);

// Instead do:
char *c = (char *)a;
void sl_foo(uint32_t *bar);
</pre></div>
</div>
</section>
<section id="dont-mix-pointer-and-value-type-declarations-required">
<h4>4.5.8 Don’t mix pointer and value type declarations (Required)<a class="headerlink" href="#dont-mix-pointer-and-value-type-declarations-required" title="Permalink to this heading"></a></h4>
<p>Don’t mix declarations of pointer type variables and value type variables on the
same line.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Don&#39;t do:
uint32_t *a, b;

// Instead do:
uint32_t *a;
uint32_t b;
</pre></div>
</div>
</section>
</section>
<section id="naming">
<h3>4.6 Naming<a class="headerlink" href="#naming" title="Permalink to this heading"></a></h3>
<section id="general-considerations">
<h4>4.6.1 General Considerations<a class="headerlink" href="#general-considerations" title="Permalink to this heading"></a></h4>
<section id="use-meaningful-names-required">
<h5>4.6.1.1 Use meaningful names (Required)<a class="headerlink" href="#use-meaningful-names-required" title="Permalink to this heading"></a></h5>
<p>Special care should be taken when naming anything. The name should convey
the purpose of the construct as clearly as possible.</p>
</section>
<section id="avoid-abbreviations-required">
<h5>4.6.1.2 Avoid abbreviations (Required)<a class="headerlink" href="#avoid-abbreviations-required" title="Permalink to this heading"></a></h5>
<p>In general, use long names and avoid unclear abbreviations and other cryptic
notations.</p>
<p>Prefixes such as <code class="docutils literal notranslate"><span class="pre">sl_</span></code> and <code class="docutils literal notranslate"><span class="pre">sli_</span></code> are exceptions to this rule and therefore can
and need to be used where appropriate.</p>
<p><strong>Exception:</strong> Well-known abbreviations in the Unify project can be used. But they must be
documented in the Unify repo in the file doc/standards/known-abbreviations.md.</p>
</section>
</section>
<section id="namespaces-required">
<h4>4.6.2 Namespaces (Required)<a class="headerlink" href="#namespaces-required" title="Permalink to this heading"></a></h4>
<p>All constructs will have a prefix, with the exception of function parameters,
variables local to a function and structure fields.</p>
<p>The purpose of using namespace prefixes is to prevent namespace collisions and
not necessarily for branding.</p>
<p>All constructs will start with the module/component prefix. The Unify Host SDK does not use
the sl or sli_prefix because it is a complete application and does not need
namespace separation from customer code. The reason for this exception is to
avoid overly long function names. Code intended for re-use in other protocol
controllers shall use the sl_ prefix to indicate that both customers and Silicon
Labs developers are expected to develop protocol controllers.</p>
</section>
<section id="naming-required">
<h4>4.6.3 Naming (Required)<a class="headerlink" href="#naming-required" title="Permalink to this heading"></a></h4>
<p>The following section (4.6.3.*) contains information on how to name anything.
This acts as a default, if nothing more specific exists for a particular
construct. In general, construct-specific standards should be avoided.</p>
<section id="casing-required">
<h5>4.6.3.1 Casing (Required)<a class="headerlink" href="#casing-required" title="Permalink to this heading"></a></h5>
<p>Every construct’s name needs to be all lower-case, with each word or
abbreviation separated by an underscore. This is also known as
<a class="reference external" href="https://en.wikipedia.org/wiki/Snake_case">snake case</a>.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Global variable
uint8_t sl_uart_char; // Publicly available
uint8_t sli_usbd_endpoint_buffer[32]; // Internal use only

// File-local variable
static sl_usbd_urb_t *urb_list_head;

// Functions
void sl_led_turn_on(void);
void sli_nvic_set_priority(ADC_IRQ);

// Data types
typedef uint32_t sli_kernel_flags_t;
typedef struct {
  uint8_t *data_start;
} sl_usbd_urb_t;
</pre></div>
</div>
</section>
<section id="casing-and-acronyms-required">
<h5>4.6.3.2 Casing and acronyms (Required)<a class="headerlink" href="#casing-and-acronyms-required" title="Permalink to this heading"></a></h5>
<p>Acronyms and abbreviations are treated like any other
word. Do not put in lower-case or upper-case some or all letters of an
abbreviation, even if it is normally written that way. Instead, comply with the
standard about that particular construct and treat acronyms as a regular word.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>static sl_usbd_urb_t *urb_list_head;

sl_led_turn_on();

sl_irq_priority_t irq_priority = sl_nvic_get_priority(ADC_IRQ);
</pre></div>
</div>
</section>
</section>
<section id="naming-functions-and-variables">
<h4>4.6.4 Naming functions and variables<a class="headerlink" href="#naming-functions-and-variables" title="Permalink to this heading"></a></h4>
<section id="functions-and-variables-names-have-the-form-verb-noun-required">
<h5>4.6.4.1 Functions and variables names have the form verb_noun (Required)<a class="headerlink" href="#functions-and-variables-names-have-the-form-verb-noun-required" title="Permalink to this heading"></a></h5>
<p>When a verb and a noun the verb acts on are in a function name, the verb should
come first (<code class="docutils literal notranslate"><span class="pre">xxxx_get_power</span></code>, not <code class="docutils literal notranslate"><span class="pre">xxxx_power_get</span></code>). It should feel natural to
read the name. Most functions should contain both a verb and a noun and
therefore need to follow this rule. Notable exceptions are functions that are
callbacks, interrupt handlers and tasks, which typically do not have a verb.
These functions follow their own naming convention, as stated in 4.6.4.5,
4.6.4.6 and 4.6.4.7, respectively.</p>
<p>Variables and functions of boolean type should use a naming style indicating the
sense of the boolean. For example <code class="docutils literal notranslate"><span class="pre">sl_usbd_device_is_connected</span></code>.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// This is for legacy EM code and does not apply to 8051
// code base.

sl_get_power();    // Call to a new-style API function.

// Below is an example of how to redefine old style API calls to the new syntax.
#if (SLAB_OLD_API == SLAB_REPLACE_OLD_API_CALLS)
#define power_get sl_get_power
#define power_set sl_set_power
#endif
</pre></div>
</div>
</section>
<section id="function-parameters-should-not-have-any-prefix-required">
<h5>4.6.4.2 Function parameters should not have any prefix (Required)<a class="headerlink" href="#function-parameters-should-not-have-any-prefix-required" title="Permalink to this heading"></a></h5>
<p>Do not prefix any function parameter with any <code class="docutils literal notranslate"><span class="pre">sl_</span></code>, <code class="docutils literal notranslate"><span class="pre">sli_</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;module&gt;_</span></code>
prefix.</p>
</section>
<section id="function-local-variables-should-not-have-any-prefix-required">
<h5>4.6.4.3 Function-local variables should not have any prefix (Required)<a class="headerlink" href="#function-local-variables-should-not-have-any-prefix-required" title="Permalink to this heading"></a></h5>
<p>Do not prefix any function-local variable with any <code class="docutils literal notranslate"><span class="pre">sl_</span></code>, <code class="docutils literal notranslate"><span class="pre">sli_</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;module&gt;_</span></code>
prefix.</p>
</section>
<section id="variable-and-function-names-indicate-units-for-time-required">
<h5>4.6.4.4 Variable and Function Names Indicate Units for Time (Required)<a class="headerlink" href="#variable-and-function-names-indicate-units-for-time-required" title="Permalink to this heading"></a></h5>
<p>When a variable is used for time, it must include the units in the name.  When
a function returns a value that is used for time it must include units in the
name.  This is important to prevent problems with accidentally
utilizing one unit of time in a function or variable that takes a different unit
of time.</p>
<p>Variables and function names may either use abbreviations or spell out the
units.  If abbreviations are used, the following shall be the abbreviations:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Full Name</th>
<th>Abbreviation (if applicable)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Years</td>
<td>Years</td>
</tr>
<tr>
<td>Days</td>
<td>Days</td>
</tr>
<tr>
<td>Hours</td>
<td>Hours</td>
</tr>
<tr>
<td>Minutes</td>
<td>Minutes</td>
</tr>
<tr>
<td>Seconds</td>
<td>Sec</td>
</tr>
<tr>
<td>Milliseconds</td>
<td>Ms</td>
</tr>
<tr>
<td>Microseconds</td>
<td>Us</td>
</tr>
<tr>
<td>Nanoseconds</td>
<td>Ns</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define SLI_JITTER_DELAY_MS 100

static void restart_discovery_after_delay(uint8_t delay_ms);

uint8_t sli_get_discovery_time_remaining_ms(void);
</pre></div>
</div>
</section>
<section id="functions-stubs-called-on-specific-events-callbacks-should-start-on-in-their-name-required">
<h5>4.6.4.5 Functions/stubs called on specific events/callbacks should start ‘on’ in their name (Required)<a class="headerlink" href="#functions-stubs-called-on-specific-events-callbacks-should-start-on-in-their-name-required" title="Permalink to this heading"></a></h5>
<p>Whenever a function is called to indicate an event occurred, or is called in
‘reaction’ to an event happenning, this function should have <code class="docutils literal notranslate"><span class="pre">on</span></code> in its name,
directly after the <code class="docutils literal notranslate"><span class="pre">&lt;module&gt;_</span></code> prefix.
This also applies to callbacks or function stubs shipped to the user.</p>
<p><strong>Example</strong>
void sl_usb_on_device_connection(void);</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sl_kernel_on_task_deletion(void);

static void on_transmit_completed(void);
</pre></div>
</div>
</section>
<section id="interrupt-handlers-should-be-suffixed-by-irqhandler-or-irq-handler-required">
<h5>4.6.4.6 Interrupt handlers should be suffixed by ‘IRQHandler’ or ‘irq_handler’ (Required)<a class="headerlink" href="#interrupt-handlers-should-be-suffixed-by-irqhandler-or-irq-handler-required" title="Permalink to this heading"></a></h5>
<p>If a function is an interrupt handler, it should either be suffixed by
<code class="docutils literal notranslate"><span class="pre">IRQHandler</span></code> if it needs to follow CMSIS’ format or by <code class="docutils literal notranslate"><span class="pre">irq_handler</span></code> if it
doesn’t (for example, if an interrupt source is shared and multiplexed) between
several handlers.</p>
<p><strong>Example</strong>
void RTCC_IRQHandler(void);</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sl_gpio_irq_handler(void);
</pre></div>
</div>
</section>
<section id="non-blocking-functions-executed-periodically-in-a-main-loop-should-be-suffixed-by-step-required">
<h5>4.6.4.7 Non-blocking functions executed periodically in a main loop should be suffixed by ‘step’ (Required)<a class="headerlink" href="#non-blocking-functions-executed-periodically-in-a-main-loop-should-be-suffixed-by-step-required" title="Permalink to this heading"></a></h5>
<p>If a non-blocking function (a function that doesn’t pend or delay before
returning) needs to be called periodically in order to check if it has
something to process and then process what it can, this function needs to be
suffixed with <code class="docutils literal notranslate"><span class="pre">step</span></code>, to indicate it executes a single round of processing. It
should not be called <code class="docutils literal notranslate"><span class="pre">tick</span></code>, since <code class="docutils literal notranslate"><span class="pre">tick</span></code> can lead to confusion with timer or
OS ticks.</p>
<p><strong>Example</strong>
void sl_cli_step(void);</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sli_usb_msc_step(void);
</pre></div>
</div>
</section>
<section id="functions-that-are-tasks-should-be-suffixed-by-task-required">
<h5>4.6.4.8 Functions that are tasks should be suffixed by ‘task’ (Required)<a class="headerlink" href="#functions-that-are-tasks-should-be-suffixed-by-task-required" title="Permalink to this heading"></a></h5>
<p>If a function is a task (in an OS environment), this function needs to be
suffixed with <code class="docutils literal notranslate"><span class="pre">task</span></code>, to indicate it is a task and needs to loop indefinitely
and never return.</p>
<p><strong>Example</strong>
void sl_cli_task(void *task_argument);</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void sli_usb_task(void *task_argument);
</pre></div>
</div>
<p><strong>Unify comment:</strong> Contiki processes are exempted from this rule and follow the
Contiki convention of a _process suffix.</p>
</section>
</section>
<section id="naming-constants">
<h4>4.6.5 Naming constants<a class="headerlink" href="#naming-constants" title="Permalink to this heading"></a></h4>
<section id="constants-should-use-upper-case-required">
<h5>4.6.5.1 Constants should use upper case (Required)<a class="headerlink" href="#constants-should-use-upper-case-required" title="Permalink to this heading"></a></h5>
<p>All constants should be named and use upper case letters. Avoid raw numbers in
code. This includes <code class="docutils literal notranslate"><span class="pre">#defines</span></code> constants, <code class="docutils literal notranslate"><span class="pre">const</span></code> variables and enum values.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#define SLI_NET_ARP_FLAG 0x0040
const unsigned int SL_MAX_UART_CONNECTIONS = 3;

typedef enum {
    SL_USBH_HC_TYPE_LIST,
    SL_USBH_HC_TYPE_PIPE
} sl_usbh_hc_type_t;
</pre></div>
</div>
</section>
</section>
<section id="naming-function-like-macros">
<h4>4.6.6 Naming function-like macros<a class="headerlink" href="#naming-function-like-macros" title="Permalink to this heading"></a></h4>
<section id="follow-the-naming-convention-for-regular-functions-required">
<h5>4.6.6.1 Follow the naming convention for regular functions (Required)<a class="headerlink" href="#follow-the-naming-convention-for-regular-functions-required" title="Permalink to this heading"></a></h5>
<p>Functional macros that can be used in the same way as functions follow the same
naming conventions as regular functions.</p>
</section>
<section id="use-all-caps-for-macros-that-cant-be-functions-required">
<h5>4.6.6.2 Use all caps for macros that can’t be functions (Required)<a class="headerlink" href="#use-all-caps-for-macros-that-cant-be-functions-required" title="Permalink to this heading"></a></h5>
<p>All caps with underscores are used for macros that cannot be made into
semantically equivalent functions.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// This is a macro function that can be used as a regular function.
#define sl_uart_init_default_uart(x) init_uart(UART0, (x))

// This is a macro function that cannot be used as a function.
#define SL_SOME_NUMBERS(x) {(x), ((x)+(x)), ((x)*(x))}
</pre></div>
</div>
</section>
</section>
<section id="naming-types">
<h4>4.6.7 Naming types<a class="headerlink" href="#naming-types" title="Permalink to this heading"></a></h4>
<section id="public-typedefs-required">
<h5>4.6.7.1 Public typedefs (Required)<a class="headerlink" href="#public-typedefs-required" title="Permalink to this heading"></a></h5>
<p>Each typedef must end with a ‘_t’ suffix and cannot start with
‘int’, ‘uint’ or ‘unicode’.</p>
</section>
<section id="structure-fields-should-be-snake-case-without-any-prefixes-required">
<h5>4.6.7.2 Structure fields should be snake_case, without any prefixes (Required)<a class="headerlink" href="#structure-fields-should-be-snake-case-without-any-prefixes-required" title="Permalink to this heading"></a></h5>
<p>There should not be any prefix (no <code class="docutils literal notranslate"><span class="pre">sl_</span></code> and no <code class="docutils literal notranslate"><span class="pre">&lt;module&gt;_</span></code>) in the name of any
structure field.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Don&#39;t do
typedef struct
{
  uint32_t sl_nvm_page_header_offset;
  uint32_t sl_nvm_page_header_size;
} sl_nvm_page_header_t;

// Instead do:
typedef struct
{
  uint32_t offset;
  uint32_t size;
} sl_nvm_page_header_t;
</pre></div>
</div>
</section>
<section id="type-from-typedef-optional">
<h5>4.6.7.3 Type from typedef (Optional)<a class="headerlink" href="#type-from-typedef-optional" title="Permalink to this heading"></a></h5>
<p>If the type is a typedef, you can optionally add a type name if there is a
reason the anonymous type does not work. In this case use the same name as the
typedef name, without the ‘_t’.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// Anonymous structure name ...
// Use this style in most cases.
typedef struct
{
  // ...
} sl_nvm_page_header_t;

// You can use this style if the struct needs a name.
typedef struct sl_nvm_page_header
{
  // ...
} sl_nvm_page_header_t;
</pre></div>
</div>
</section>
</section>
<section id="files-and-directory-structure">
<h4>4.6.8 Files and directory structure<a class="headerlink" href="#files-and-directory-structure" title="Permalink to this heading"></a></h4>
<section id="filenames-and-directories-use-lower-case-required">
<h5>4.6.8.1 Filenames and directories use lower case (Required)<a class="headerlink" href="#filenames-and-directories-use-lower-case-required" title="Permalink to this heading"></a></h5>
<p>All file names are lower case and multiple words are separated with one
underscore ‘_’.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sl_packet_buffer.c
</pre></div>
</div>
</section>
<section id="avoid-duplicate-filenames">
<h5>4.6.8.2 Avoid duplicate filenames<a class="headerlink" href="#avoid-duplicate-filenames" title="Permalink to this heading"></a></h5>
<p>Avoid using the same file name for source files.</p>
<p><strong>Note:</strong> Among our entire source code there will be files with the same name.
This cannot be avoided. But files with the same name should never be used in the
same project/build.</p>
</section>
<section id="file-names-required">
<h5>4.6.8.3 File names (Required)<a class="headerlink" href="#file-names-required" title="Permalink to this heading"></a></h5>
<p>File names (both for library and source) should include the namespace prefix of
the module.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>foobar_controller.c
mymod_status.h
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sl_</span></code> prefix is not used in the Unify Host SDK, because it produces an integrated
application without clear distinction between customer and company modules.</p>
</section>
<section id="directory-names-required">
<h5>4.6.8.4 Directory names (Required)<a class="headerlink" href="#directory-names-required" title="Permalink to this heading"></a></h5>
<p>Directories use lower case names and underscores as word separators. Subfolder
names do not need to be unique.</p>
</section>
</section>
</section>
</section>
<hr class="docutils" />
<section id="documentation">
<h2>5 Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading"></a></h2>
<section id="general">
<h3>5.1 General<a class="headerlink" href="#general" title="Permalink to this heading"></a></h3>
<p>Write documentation so that others can easily pick up the code. It makes life
easier for everyone. In particular, it makes supports job a lot easier as it
will generate less support requests.</p>
</section>
<section id="comments-should-answer-the-question-why-required">
<h3>5.2 Comments should answer the question “Why?” (Required)<a class="headerlink" href="#comments-should-answer-the-question-why-required" title="Permalink to this heading"></a></h3>
<p>Write comments that say why the code is the way it is. What the code does, and
how it does it, can usually be figured out from the code itself. Why it does it,
and why it does it the way that it does, cannot. If you write it the obvious
way, and it doesn’t work, explain in a comment why it didn’t. Otherwise the next
person to come along is going to convert it back to the obvious method and have
to learn the same painful lesson (or even worse, force you to relearn it).</p>
<p>There needs to be enough documentation that a peer can read and understand the
code without having to ask the author for explanations. If a code reviewer feels
the need to ask for explanations about how stuff works, then the code author
should add this additional information as comments in the code.</p>
<p>Comments should use correct grammar and full sentences.</p>
</section>
</section>
<hr class="docutils" />
<section id="doxygen-coding-style-guide">
<h2>6 Doxygen Coding Style Guide<a class="headerlink" href="#doxygen-coding-style-guide" title="Permalink to this heading"></a></h2>
<p>Doxygen is used to document all code that is released to customers, with a focus
on functions that are part of an API. For code that is only used internally it
is still strongly recommended to use Doxygen commenting as internal users will
find it useful.</p>
<p>For file and function comment blocks, the following style is used:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/**
 * doc comments ...
 */
</pre></div>
</div>
<p>For all other doc comments, the C++ style <code class="docutils literal notranslate"><span class="pre">///</span></code> is used.</p>
<section id="file-comment-header-required">
<h3>6.1 File comment header (Required)<a class="headerlink" href="#file-comment-header-required" title="Permalink to this heading"></a></h3>
<p>All source files should have a file comment header that looks similar to the
following. The actual license text will depend on the project. See section 7
for details about licenses.</p>
</section>
<section id="grouping-modules-addtogroup-recommended">
<h3>6.2 Grouping modules (&#64;addtogroup) (Recommended)<a class="headerlink" href="#grouping-modules-addtogroup-recommended" title="Permalink to this heading"></a></h3>
<p>Use the Doxygen command <code class="docutils literal notranslate"><span class="pre">&#64;addtogroup</span></code> to group together source code that belongs
to the same module, for example UART and SPI and so on. This will make it easier
for customers to find the API documentation for the modules they are interested
in.</p>
<p>It is also possible to create groups hierarchies, for example to have an ADC
group in the EM_Library group.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/**
 * @addtogroup EM_Library
 * @{
 */

/// variable, constants and code belonging to EM_Library
/// (but not in the ADC module).
uint32_t sl_some_global_variable;

/**
 * @addtogroup ADC
 * @brief Analog to Digital Converter (ADC) Peripheral API
 * @{
 */

/// variable, constants and code belonging to EM_Library and ADC module
bool sl_is_adc_configured;

/** @} (end addtogroup ADC) */

/** @} (end addtogroup EM_Library) */

/// @} (end groupName)
</pre></div>
</div>
</section>
<section id="file-module-level-documentation-recommended">
<h3>6.3 File/module level documentation (Recommended)<a class="headerlink" href="#file-module-level-documentation-recommended" title="Permalink to this heading"></a></h3>
<p>If a file is part of a module, it may be desirable to include file-level
documentation. For example, the file level documentation may provide an overview
of how to use an API. To provide file-level documentation, a Javadoc style
Doxygen comment block should follow the file include statements.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/**
 *
 * @addtogroup adc_group ADC API
 *
 * @brief Brief one-sentence description of ADC module.
 *
 * The rest of this section can be multi paragraph explanation of the
 * module. It can include tables and code examples. End the description
 * as shown below and this will collect the remaining API documentation
 * into this group.
 *
 * @{
 *
 */
</pre></div>
</div>
<p>If a group is created as shown above, it needs to be closed at the end of the
file using one of the two methods shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>// The following is used if there is only one group in a file or
// groups are not nested.

/// @} end adc_group

// The following is used when groups are nested. This is needed so
// that doxygen does not pick up the &quot;end adc_group&quot; as part of a doc
// comment for a following or enclosing group.

/** @} end adc_group */
</pre></div>
</div>
<blockquote>
<div><p><strong>Comment:</strong> The method used is optional. If in doubt about whether the second
method is needed, run Doxygen on your file and see if the “end” comment is being
picked up in the documentation.</p>
</div></blockquote>
</section>
<section id="function-documentation-required">
<h3>6.4 Function documentation (Required)<a class="headerlink" href="#function-documentation-required" title="Permalink to this heading"></a></h3>
<p>This is required for any library or module code that will be customer facing. It
is also highly recommended to document any other code in the same way, even if
it is not expected to be customer-facing. Often times non-customer-facing code
ends up being delivered to a customer anyway.</p>
<p>Normally, functions that are part of an example (like main) or other simple
functions that are part of the application and not library or module functions
are not documented with Doxygen. It may still be useful to use Doxygen to
provide documentation for complex examples.</p>
<p>Each function definition contains at least a function brief statement and list
of parameters and return value if any. Doxygen will pick up a single sentence at
the start of the comment block as the brief description, so the <code class="docutils literal notranslate"><span class="pre">&#64;brief</span></code> tag is
not necessary.</p>
<p>If the function contains parameters and a return value, then these parameters
and return value must also be documented in Doxygen.</p>
<p>Optionally the <code class="docutils literal notranslate"><span class="pre">&#64;note</span></code> command can be used to highlight anything that the user
should pay extra attention to when using this function.</p>
<p>It is useful to read the Doxygen documentation about how you can write good
documentation for your functions. Besides <code class="docutils literal notranslate"><span class="pre">&#64;note</span></code>, there are other tags that can
also be used. For example <code class="docutils literal notranslate"><span class="pre">&#64;sa</span></code> (see also) can be used to create a link to
another documented section. If you put a full function name or variable name
that Doxygen knows about, it will automatically create a link to the
documentation for that other function or variable. For macros you can add the
<code class="docutils literal notranslate"><span class="pre">&#64;ref</span></code> tag before the item name and a link will be generated.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/**
 * Brief description of function.
 *
 * @param myParam1 is a parameter that is most excellent
 * @param myParam2 is not such a good parameter
 * @returns Returns true on Tuesdays or whenever it is raining.
 *
 * Detailed description here. Can be multiple sentences. Can
 * contain markdown (tables, code examples, bulleted lists)
 *
 * Can add as many additional paragraphs as needed.
 *
 * @note A note if the API needs a note.
 */
 uint8_t sl_my_public_function(uint8_t my_param1, uint16_t my_param2)
 {
   // ...
 }
</pre></div>
</div>
</section>
<section id="variable-documentation-required">
<h3>6.5 Variable documentation (Required)<a class="headerlink" href="#variable-documentation-required" title="Permalink to this heading"></a></h3>
<p>All public variables that are part of an API must be documented. It is also
recommended to document all file-level global variables even if they are not
public.</p>
<p><strong>Note:</strong> It is not necessary to document local (automatic) variables.</p>
<p>Many variable will only require a single line or brief comment. In this case you
should use a C++ style doxygen comment <code class="docutils literal notranslate"><span class="pre">///</span></code>. You can use this same style even
for several lines of a documenting comment. However, if the variable requires a
large documentation block or needs to be visually separated from other sections
of the source code file, then use the same style blocks as used for functions.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/// A brief description of this variable.
uint8_t sl_meaningful_variable_name;

/// This variable has a brief line of documentation.
/// Then it also has some additional lines of documentation.
uint32_t sl_another_variable;

/**
 * Brief description of complicated variable.
 * Additional extra documentation for this complicated variable that
 * needs a bigger explanation. Or perhaps I just want this variable to
 * stand out in my source file so I use the large comment blocks.
 */
</pre></div>
</div>
<p>For fields of a structure, or a list of constants or anything that requires just
a brief comment, there is another style (post) that can be used. In this case
you put the doc comment on the same line as the item (instead of before it). To
do this the comment needs to start like this: <code class="docutils literal notranslate"><span class="pre">///&lt;</span> <span class="pre">Brief</span> <span class="pre">comment.</span></code></p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/// A brief comment about this data type.
/// I can follow with additional explanation as needed, perhaps how
/// it is used or allowed values or constraints.
typedef struct
{
    uint8_t r;    ///&lt; Brief comment about this field.
    uint8_t g;    ///&lt; Green pixel value.
    uint8_t b;    ///&lt; Blue pixel value.
} sl_pixel_t;
</pre></div>
</div>
</section>
<section id="header-file-vs-implementation-file-recommended">
<h3>6.6 Header file vs. implementation file (Recommended)<a class="headerlink" href="#header-file-vs-implementation-file-recommended" title="Permalink to this heading"></a></h3>
<p>To keep a simple distinction between public documentation and internal
documentation, all public documentation comments should be placed into the
library or module header (.h) file. This allows us to just pull in header files
when generating public-facing documentation and not need to worry about
separation of public or private content.</p>
<p>The implementation file (.c) should also be documented if there additional non-
public functions or variables that are not part of the public documentation. The
.c doc comments can be used for generating internal documentation.</p>
<p>If a function in a .c file is already documented in the header file, then it is
not necessary to repeat the documentation. However, a comment block should be
used with the brief description to visually mark the function in the source
file.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/**
 * Brief description of function.
 */
 uint8_t sl_do_something(uint8_t my_param1, uint16_t my_param2)
</pre></div>
</div>
<p>If the function is a private (<code class="docutils literal notranslate"><span class="pre">static</span></code>) function then it should use a normal
comment block (same as public function in a header file). Private variables
should also be documented.</p>
</section>
<section id="do-not-document-sections-recommended">
<h3>6.7 Do not document sections (Recommended)<a class="headerlink" href="#do-not-document-sections-recommended" title="Permalink to this heading"></a></h3>
<p>The Doxygen configuration file for the project should be configured to exclude
undocumented objects. Therefore it is not necessary to add extra statements to
exclude Doxygen processing. Simply do not add Doxygen comments to the code you
do not want documented.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/// The following variable will be picked as part of the
/// documentation.
uint8_t sl_my_public_variable;

// This variable should also have a comment to explain it,
// but by using only double-slash, it will not get picked
// up by Doxygen.
static uint8_t my_private_variable;

/*
 * This is a function that will not be documented.
 *
 * Note the lack of the double asterisk at the end of the top line. That
 * means this is not a true Javadoc comment block and Doxygen will not
 * see it.
 */
void sli_do_something_secret(void)
{
  // ...
}
</pre></div>
</div>
</section>
<section id="do-not-release-sections-recommended">
<h3>6.8 Do not release sections (Recommended)<a class="headerlink" href="#do-not-release-sections-recommended" title="Permalink to this heading"></a></h3>
<p>There may be instances where there are source files which contain sections that
should not be released, for example references to an emulator or todo comments.
In some build systems, you may use commented double square brackets (<code class="docutils literal notranslate"><span class="pre">//[[...]]</span> <span class="pre">or</span></code>//[[<code class="docutils literal notranslate"><span class="pre">and</span></code>//]]`) to hide such code. You must make sure that the build
system used on said source runs the codestripper before relying on this
functionality.</p>
<p><strong>Example</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>//[[
// Don&#39;t release this define
#define SL_EMULATOR_CONFIG 1
//]]
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="licensing">
<h2>7 Licensing<a class="headerlink" href="#licensing" title="Permalink to this heading"></a></h2>
<section id="silicon-labs-licenses">
<h3>7.1 Silicon Labs Licenses<a class="headerlink" href="#silicon-labs-licenses" title="Permalink to this heading"></a></h3>
<p>All of our released source files (.c, .h, others; generated and manually
written) should fall under one of the few licenses approved by our legal team.
All source files are therefore required to have a file comment header
containing the correct license type.</p>
<ul class="simple">
<li><p>The <a class="reference download internal" download="" href="../../_downloads/e1d4e66788a26d2fd0d184181d1c1c3e/license-header-standard.h"><span class="xref download myst">default license text</span></a> must be used unless
otherwise specified.</p></li>
<li><p>The <a class="reference download internal" download="" href="../../_downloads/345db600d9e376028745fccc7a854f9f/license-header-third-party.h"><span class="xref download myst">third-party license text</span></a> is added on top
of any third-party code. It does not remove the existing text. If we include
any third party software, we need a way to clearly identify it as such. Yes,
this is extra work, but is required by our legal team. Using and releasing
third-party code has more constraints, see section 7.2 for the details.</p></li>
</ul>
<p>Please note that the version field in these headers is optional. If used, the
version field should be used to denote the component version, not the Gecko
SDK version.</p>
</section>
<section id="third-party-code">
<h3>7.2 Third-Party Code<a class="headerlink" href="#third-party-code" title="Permalink to this heading"></a></h3>
<p>We generally favor writing and maintaining our own code when the differences
(in effort, quality, market acceptance, etc.) with an open-source one are
small.</p>
<p>The VP of Software must give his consent before any kind of third-party code is
allowed to be used, as special care must be taken when dealing with this type
of code. Specifically, content licensed to us under a “copyleft” license (GPL
and other viral open-source licenses) <strong>must not be released</strong>, including in
compiled form (such as a library or binary).</p>
<p>New copyleft content should not be added. Existing copyleft released content
must be audited against this rule, documented and flagged to the VP of Software
for quick resolution. Whenever feasible and regardless of whether it is being
released or is a documented exception, existing copyleft content should be
replaced.</p>
<p>Content that is “multi-licensed” (offered to us under our choice of more than
one license) is not considered copyleft if at least one of the offered licenses
is not copyleft.</p>
</section>
</section>
<hr class="docutils" />
<section id="id3">
<h2>8 C++ Specific Guidelines<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h2>
<p>C is our primary language because we assume that a larger customer base will be
familiar with C. We are gradually introducing C++ where it makes sense.
Essentially, where the benefits of a particular C++ language feature outweighs
the maintenance cost associated with customer education, tooling maintenance and
developer cognitive overhead.</p>
<p>Automatic mocking with CMock is an integral part of our effort to have
comprehensive unit test coverage. Automatic mocks of C++ code present unique
challenges. Particularly, there is no C++ equivalent of the automatic mock
creation feature of CMock.</p>
<ol class="arabic simple">
<li><p>Components must expose a C API even when using C++
internally for the implementation. This can be a thin C wrapper around a C++
component. This requirement may however be omitted for some cases, which are
described below.</p></li>
<li><p>Component may expose C++ APIs that are mockable using CMock. E.g. by also
exposing a C API wrapping the C++ API and mocking that with CMock.</p></li>
<li><p>Trivial components that do not require unit testing may expose C++ APIs that
are not mockable with CMock. E.g. simple converters.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer>
    <hr/>
    <p>Copyright © 2023 Silicon Laboratories. All rights reserved.</p>
</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>