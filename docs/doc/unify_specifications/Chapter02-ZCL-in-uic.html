<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="Dotdot ZCL in Unify Framework for Application level control" name="description" />
<meta content="Application, control, dotdot" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. Dotdot ZCL in Unify Framework for Application Level Control &mdash; Unify Host SDK</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom_styles.css" type="text/css" />
    <link rel="canonical" href="https://siliconlabs.github.io/UnifySDK/doc/unify_specifications/Chapter02-ZCL-in-uic.html" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/js/charenc.js"></script>
        <script src="../../_static/js/crypt.js"></script>
        <script src="../../_static/js/sha1.js"></script>
        <script src="../../_static/js/html5-qrcode.min.js"></script>
        <script src="../../_static/js/qr_code_scanner.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3. Network Management Commands" href="Chapter03-network-management.html" />
    <link rel="prev" title="1. Unify Architecture Overview" href="Chapter01-architecture-overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../introduction.html" class="icon icon-home"> Unify
            <img src="../../_static/silicon-labs-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                ver_1.3.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Unify Host SDK</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../UnifySDK.html">Unify Framework</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../UnifySDK.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UnifySDK.html#systems-overview">Systems Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UnifySDK.html#unify-applications-overview">Unify Applications Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UnifySDK.html#overview-of-relations-among-unify-applications">Overview of relations among Unify Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UnifySDK.html#overview-of-communication-among-unify-framework-applications">Overview of communication among Unify Framework Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UnifySDK.html#unify-framework-release-notes">Unify Framework Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../UnifySDK.html#unify-framework-developer-guides">Unify Framework Developer Guides</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../UnifySDK.html#resources">Resources</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Unify Specifications</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Chapter01-architecture-overview.html">1. Unify Architecture Overview</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">2. Dotdot ZCL in Unify Framework for Application Level Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter03-network-management.html">3. Network Management Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter04-scenario-mappings.html">4. Scenario mapping to specific PHYs: Z-Wave, BLE and ZigBee</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter05-common-ota.html">5. Common OTA FW Update Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter06-service-discovery.html">6. Service Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter07-scenes.html">7. Scene Cluster and the Scene Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter08-aox-application.html">8. AoX Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter09-binding.html">9. Binding</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter10-name-and-location-service.html">10. Name and Location Service</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter11-system-metrics.html">11. System Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="Chapter12-unify-applications-monitoring.html">12. Unify Applications Monitoring</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../standards/known-abbreviations.html">Known Abbreviations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../multiprotocol.html">Multiprotocol Host Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started with the Unify Host SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../readme_developer.html">Unify Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system_requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qr_code_scanner.html">QR-Code Scanner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../introduction.html">Unify</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <script>
    $(".wy-side-scroll").append("<div class='github-button'><iframe src='https://ghbtns.com/github-btn.html?user=SiliconLabs&repo=UnifySDK&type=watch&count=true&size=large&v=2' allowtransparency='true' frameborder='0' scrolling='0' width='170' height='30'></iframe></div>");
</script>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dotdot-zcl-in-unify-framework-for-application-level-control">
<span id="unify-specifications-chapter-zcl-in-unify-application-level-control"></span><h1><span class="section-number">2. </span>Dotdot ZCL in Unify Framework for Application Level Control<a class="headerlink" href="#dotdot-zcl-in-unify-framework-for-application-level-control" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2><span class="section-number">2.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>This chapter provides application examples about the usage of
the DotDot Zigbee cluster library specification <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>
in the Unify framework considering that the node capabilities
have been discovered (i.e., the supported clusters, commands and attributes).
The Unify framework uses MQTT transport protocol as an internal message
transportation between Clients (IoT Service API, Protocol Controller, and so on),
and unified controller application language that enables seamless
communications across a Unify network.</p>
<p>In the Unify framework, every Protocol Controller must discover the capability of
the PAN nodes in its network and advertise the capabilities of each node
(supported commands and attributes) to interested parties (i.e., IoT Service for
a cloud service like AWS-IOT) using MQTT protocol. This procedure known as
<a class="reference internal" href="Chapter06-service-discovery.html#unify-specifications-chapter-service-discovery"><span class="std std-ref">Service Discovery</span></a>.</p>
<p>After the PAN nodes capabilities have been discovered, the IoT service MQTT
clients can control and observe the behavior of the nodes using the unified controller application
language. The unified application language is based on a publish/subscribe
messaging transport protocol and the dotdot/ZigBee Cluster library (ZCL)
specification.</p>
</section>
<section id="mqtt-topics">
<h2><span class="section-number">2.2. </span>MQTT Topics<a class="headerlink" href="#mqtt-topics" title="Permalink to this heading"></a></h2>
<p>The MQTT topics are divided into sub-spaces for each device to allow a Protocol
Controller to advertise state and capabilities of a given device and IoT
Services to read the state and control a given device.</p>
<p>There are three main spaces in a cluster MQTT topic, as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ucl/by-unid/+/+/&lt;ClusterName&gt;/Attributes/#</span></code> : This represents the
cluster attributes state.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ucl/by-unid/+/+/&lt;ClusterName&gt;/SupportedCommands</span></code>: This represents the
list of commands that the node can receive for this cluster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ucl/by-unid/+/+/&lt;ClusterName&gt;/Commands/+</span></code> : This is the topic where
IoT Services issue commands.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ucl/by-unid/+/+/&lt;ClusterName&gt;/SupportedGeneratedCommands</span></code>: This represents
the list of commands that the node can generate for this cluster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ucl/by-unid/+/+/&lt;ClusterName&gt;/GeneratedCommands/+</span></code> : This is the topic where
IoT Services receives commands from PAN nodes.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">/+/+</span></code> wildcards can be replaced with a specific UNID and endpoint to
control/monitor only a single endpoint.</p>
<p>An overview of these topics is shown in
<a class="reference internal" href="#table-unify-specifications-mqtt-topic-space-overview"><span class="std std-numref">Table 2.1</span></a>.</p>
<table class="colwidths-given docutils align-default" id="table-unify-specifications-mqtt-topic-space-overview" style="width: 50%">
<caption><span class="caption-number">Table 2.1 </span><span class="caption-text">MQTT Topic space overview</span><a class="headerlink" href="#table-unify-specifications-mqtt-topic-space-overview" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 60%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>MQTT Topic</p></th>
<th class="head"><p>Protocol</p>
<p>Controllers</p>
</th>
<th class="head"><p>IoT</p>
<p>Services</p>
</th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Attributes/&lt;AttributeName&gt;/Reported</p></td>
<td><p>Publish</p>
<p>(retained)</p>
</td>
<td><p>Subscribe</p></td>
<td><p>Advertises the reported value of an attribute for the Cluster.</p></td>
</tr>
<tr class="row-odd"><td><p>ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Attributes/&lt;AttributeName&gt;/Desired</p></td>
<td><p>Publish</p>
<p>(retained)</p>
</td>
<td><p>Subscribe</p></td>
<td><p>Advertises the desired value of an attribute for the Cluster.</p></td>
</tr>
<tr class="row-even"><td><p>ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Attributes/#</p></td>
<td><p>Publish</p>
<p>(retained)</p>
</td>
<td><p>Subscribe</p></td>
<td><p>Advertises the reported/desired value of a non-standard attribute</p>
<p>for the Cluster. Non-standard attributes are defined in this</p>
<p>specification. The last level of this topic space will always</p>
<p>be /Reported or /Desired.</p>
</td>
</tr>
<tr class="row-odd"><td><p>ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/SupportedCommands</p></td>
<td><p>Publish</p>
<p>(retained)</p>
</td>
<td><p>Subscribe</p></td>
<td><p>Advertises an array of commands that can be published under</p>
<p>the Commands/# namespace by IoT Services to control the device.</p>
</td>
</tr>
<tr class="row-even"><td><p>ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Commands/&lt;CommandName&gt;</p></td>
<td><p>Subscribe</p></td>
<td><p>Publish</p>
<p>(unretained)</p>
</td>
<td><p>Instruct a Protocol Controller to send a command</p>
<p>to the UNID/endpoint server cluster.</p>
</td>
</tr>
<tr class="row-odd"><td><p>ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/SupportedGeneratedCommands</p></td>
<td><p>Publish</p>
<p>(retained)</p>
</td>
<td><p>Subscribe</p></td>
<td><p>Advertises an array of commands that can be generated under</p>
<p>the GeneratedCommands/# namespace by Protocol Controller</p>
<p>as commands sent from the device.</p>
</td>
</tr>
<tr class="row-even"><td><p>ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/GeneratedCommands/&lt;CommandName&gt;</p></td>
<td><p>Publish</p>
<p>(unretained)</p>
</td>
<td><p>Subscribe</p></td>
<td><p>Receive commands sent from the UNID/endpoint cluster to Unify.</p></td>
</tr>
</tbody>
</table>
<section id="reported-and-desired">
<span id="unify-specifications-section-reported-and-desired"></span><h3><span class="section-number">2.2.1. </span>Reported and Desired<a class="headerlink" href="#reported-and-desired" title="Permalink to this heading"></a></h3>
<p>The state of a cluster for a device/endpoint is represented by a list of
attributes, additional (non-standard) attributes, and a list of supported
commands.</p>
<p>A PAN node may perform state transitions or delays may occur between an IoT
Service issuing an MQTT command and the device itself confirming that its state
matches what the IoT Service wished to accomplish. For that purpose, each
attribute in a Cluster has two values, a <em>desired</em> and a <em>reported</em> value.
The <em>desired value</em> indicates what the Protocol Controller attempts to get
device/endpoint to reach. The <em>reported value</em> indicates the state confirmed by
the device/endpoint itself.</p>
<p>More information about the ‘desired’ and ‘reported’ state description can be
found in the
<a class="reference external" href="https://docs.aws.amazon.com/iot/latest/developerguide/device-shadow-document-syntax.html#device-shadow-example-request-json">Amazon AWS Specification</a>.</p>
</section>
<section id="cluster-mqtt-topics">
<h3><span class="section-number">2.2.2. </span>Cluster MQTT Topics<a class="headerlink" href="#cluster-mqtt-topics" title="Permalink to this heading"></a></h3>
<p>IoT Services (Cloud Service connectors, Middleware Translator, and Rules Engines)
should subscribe to the following topic filter to get any application message
corresponding to the state of given cluster from any PAN node in the
Unify network:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/+/+/&lt;ClusterName&gt;/#</span>
</pre></div>
</div>
<p>The Protocol Controllers MUST then publish to the following topics to advertise
the supported attributes of a PAN Node and also when the attributes state is
updated:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Attributes/&lt;AttributeName&gt;/Reported</span> - {<span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span>}
</pre></div>
</div>
<p>For each attribute, the value property is required. This represents the value
of the attribute and it can be any of the following JSON types:</p>
<ul class="simple">
<li><p>string</p></li>
<li><p>number</p></li>
<li><p>boolean</p></li>
<li><p>null</p></li>
<li><p>an object, containing boolean types (only for bitmasks)</p></li>
</ul>
<p>Strings must always be UTF-8 encoded, have a maxlength of 256 bytes, regardless of the
limits specified in ZCL.</p>
<p>For example, a Protocol Controller advertising the state of a device/endpoint
being a OnOff and Level cluster server will publish the following:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span>}
</pre></div>
</div>
<p>Furthermore, in the example above, the PAN node is dimming its level from 100% to
50%. When it reaches 50% and the Protocol Controller has received a confirmation,
the reported state of the CurrentLevel attribute will be updated to match the
desired value.</p>
<p>Strings MUST be used by Protocol Controllers when a descriptive name is
given to the possible values for a given attribute by the DotDot XML files.
For example, the <em>LockState</em> attribute of a door lock MUST be published as
follows:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Lock/Attributes/LockState/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Locked&quot;</span>}
</pre></div>
</div>
<p>If the individual values do not have a description string name, their value MUST
be presented using either a JSON number or boolean. See the
ZCL Cluster Library <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>.</p>
<p>Finally, only JSON objects are allowed for bitmaps/bitmasks when names are
defined in the ZCL Cluster Library <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>. Numbers MUST
NOT be used in this case. For example, the ColorCapabilities attribute of the
ColorControl cluster MUST be represented as follows:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/ColorControl/Attributes/ColorCapabilities/Reported</span> -
{
<span class="w">  </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">    </span><span class="nt">&quot;HueSaturationSupported&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;EnhancedHueSupported&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ColorLoopSupported&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;XYSupported&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ColorTemperatureSupported&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span>}
}
</pre></div>
</div>
<section id="mandatory-cluster-attributes">
<h4><span class="section-number">2.2.2.1. </span>Mandatory Cluster Attributes<a class="headerlink" href="#mandatory-cluster-attributes" title="Permalink to this heading"></a></h4>
<p>PAN Nodes may support more than the minimum mandatory set of attributes for a
given cluster. When a node is interviewed and its capabilities are discovered,
a Protocol Controller MUST, at a minimum, publish all attributes for a cluster
that are specified as <em>mandatory</em> in the ZigBee Cluster library.</p>
<p>For example, for a PAN Node supporting the OnOff cluster, it will be guaranteed
that the <em>OnOff</em> attribute will be published, however, the
<em>GlobalSceneControl</em> will be published only if supported by the PAN node.</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/GlobalSceneControl/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/GlobalSceneControl/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
</pre></div>
</div>
</section>
<section id="missing-mandatory-cluster-attributes-and-commands">
<h4><span class="section-number">2.2.2.2. </span>Missing Mandatory Cluster Attributes and Commands<a class="headerlink" href="#missing-mandatory-cluster-attributes-and-commands" title="Permalink to this heading"></a></h4>
<p>Because of multiple PHYs and the application level variety between them,
a node might be shown as a ZCL cluster server, despite missing mandatory
attributes and/or commands. A protocol controller MUST do whatever it can to
map or emulate all required attributes and commands. Only in situations
where there is no meaningful way to do a map, the protocol controller may
omit the mapping.</p>
<p>For example, in Z-Wave, it is possible to have Thermostats without a local
temperature reading. These thermostats can nonetheless be controlled by MQTT
clients and the lack of a temperature reading should not prevent the exposition
of such a device to the IoT Services.</p>
<p>In this case, the value of the attribute MUST be set to a null JSON type. For
instance, a thermostat without local temperature MAY be published as follows:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/LocalTemperature/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/LocalTemperature/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedCoolingSetpoint/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2600</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedCoolingSetpoint/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2600</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedHeatingSetpoint/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2100</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedHeatingSetpoint/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2100</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/SystemMode/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Auto&quot;</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/SystemMode/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Auto&quot;</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ThermostatProgrammingOperationMode/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ThermostatProgrammingOperationMode/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ControlSequenceOfOperation/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ControlSequenceOfOperation/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>}
</pre></div>
</div>
<p>In any case, a Protocol Controller SHOULD publish the <em>LocalTemperature</em> attribute
state when publishing a node as a Thermostat Cluster server because it is a
mandatory attribute.</p>
<p>When a reported state is updated from the PAN node, the Protocol
Controllers MUST update both the reported and desired values of the
corresponding attributes. In this case, Protocol Controllers SHOULD publish the
desired part of the updated state first.</p>
</section>
<section id="cluster-revisions">
<h4><span class="section-number">2.2.2.3. </span>Cluster Revisions<a class="headerlink" href="#cluster-revisions" title="Permalink to this heading"></a></h4>
<p>A special attribute under every cluster called ClusterRevision is used to
advertise the ZCL revision of the cluster that the node and/or Protocol
Controller are using.</p>
<p>ProtocolControllers MUST publish this information for all clusters of all
nodes they advertise.</p>
<p>See the the ZCL Cluster Library <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a> for Cluster
revision details.</p>
<p>The JSON value type for the ClusterRevision attribute MUST be an integer.
Both Desired and Reported values MUST be published by Protocol Controllers.
The ClusterRevision is a read-only attribute.</p>
<p>For example, publishing the cluster revision of an OnOff node:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
</pre></div>
</div>
</section>
<section id="additional-attributes">
<h4><span class="section-number">2.2.2.4. </span>Additional Attributes<a class="headerlink" href="#additional-attributes" title="Permalink to this heading"></a></h4>
<p>Additional attributes under a cluster state can be used to advertise state
information that is not standardized as Cluster attributes.</p>
<p>The format of this additional state information is UCL-specific and defined in
this specification. It follows as closely as possible the data models described
in the ZCL Cluster Library <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>.</p>
<p>The additional state information can be affected by the use of commands and
it MUST also follow a desired/reported state. Most clusters do not have any
additional attributes defined.</p>
<p>Additional attributes MUST be published under the same <code class="docutils literal notranslate"><span class="pre">Attributes/</span></code> MQTT topic
hierarchy as the standard cluster attributes, however, the MQTT topic hierarchy
MAY contain additional levels before the final Desired or Reported level.</p>
<p>For example, the Scene Cluster definition uses a Scene Table, which
is advertised to the IoT Services using a UCL-specific definition.
This specification will provide a JSON schema for all Additional Attributes
not present in the dotdot XML files.</p>
<p>For example, from the <a class="reference internal" href="Chapter07-scenes.html#unify-specifications-chapter-scenes"><span class="std std-ref">The Dotdot Scenes Cluster (0x0005) in the Unify Framework</span></a>, this is the
JSON schema for the SceneTable:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Scenes/Attributes/SceneTable/Desired</span> -
{
<span class="w">  </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span>{
<span class="w">      </span><span class="nt">&quot;SceneID&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;GroupID&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;SceneName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cozy Scene&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;TransitionTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;TransitionTime100ms&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;SceneTableExtensions&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">        </span><span class="nt">&quot;OnOff&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">          </span><span class="nt">&quot;OnOff&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span>}<span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">          </span><span class="nt">&quot;CurrentLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<span class="w">        </span>}<span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;ColorControl&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">          </span><span class="nt">&quot;CurrentX&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;CurrentY&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3455</span>
<span class="w">        </span>}
<span class="w">      </span>}
<span class="w">    </span>}<span class="p">,</span>
<span class="w">    </span>{
<span class="w">      </span><span class="nt">&quot;SceneID&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;GroupID&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;SceneName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Away from home&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;TransitionTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;TransitionTime100ms&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;SceneTableExtensions&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">        </span><span class="nt">&quot;OnOff&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">          </span><span class="nt">&quot;OnOff&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span>}<span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="w"> </span>{
<span class="w">          </span><span class="nt">&quot;CurrentLevel&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span>}
<span class="w">      </span>}
<span class="w">    </span>}
<span class="w">  </span><span class="p">]</span>
}
</pre></div>
</div>
</section>
<section id="commands-supported-by-pan-node">
<h4><span class="section-number">2.2.2.5. </span>Commands Supported by PAN Node<a class="headerlink" href="#commands-supported-by-pan-node" title="Permalink to this heading"></a></h4>
<p>IoT Services MUST be able to read the commands that are supported for a cluster
server under a UNID/Endpoint to control them.</p>
<p>The list of supported Commands for each PAN node MUST be advertised by the Protocol
Controllers in the <em>SupportedCommands</em> topic under the Cluster level.</p>
<p>The list of supported Commands MUST be advertised using a JSON array containing
strings. For example, the list of supported commands for the OnOff cluster could
look like this:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/SupportedCommands</span> -
{
<span class="w">  </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;On&quot;</span><span class="p">,</span><span class="s2">&quot;Off&quot;</span><span class="p">,</span><span class="s2">&quot;Toggle&quot;</span><span class="p">,</span><span class="s2">&quot;ForceReadAttributes&quot;</span><span class="p">,</span><span class="s2">&quot;WriteAttributes&quot;</span><span class="p">]</span>
}
</pre></div>
</div>
<p>It is OPTIONAL for a Protocol Controller to publish the availability of the
<em>WriteAttributes</em> and <em>ForceReadAttributes</em> commands.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A ProtocolController MAY publish an empty array for the SupportedCommands
of a cluster. In this case, IoT Services can only use the WriteAttributes commands
if the cluster contains writable attributes.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>IoT Services MUST NOT wait for a feedback after sending a ForceReadAttributes command.
This command is used to <em>force</em> an update on the usual feedback channels - i.e.,
the <em>reported</em> MQTT topic.</p>
</div>
<p>Protocol Controllers SHOULD explicitly advertise the availability of the
<em>WriteAttributes</em> Command in the SupportedCommands topic when there is at least
one writable attribute supported by the PAN node
(i.e., marked as <code class="docutils literal notranslate"><span class="pre">writable=true</span></code> in the ZCL cluster definition).</p>
<p>Protocol Controllers SHOULD NOT advertise the availability of the
<em>WriteAttributes</em> Command in the SupportedCommands topic when there is no
writable attribute supported by the PAN node for the cluster. IoT Services MAY
use this command but it will have no effect.</p>
<p>Protocol Controllers SHOULD explicitly advertise the availability of the
<em>ForceReadAttributes</em> Command in the SupportedCommands topic when there is at least
one readable attribute that is of a type not of an integer or floating point type
(i.e., an attribute of type “String” or other complex data types).</p>
<p>Protocol Controller SHOULD advertise the <em>ForceReadAttributes</em> Command for all
endpoints with readable mandatory attributes, as supported in the ZCL cluster definition.</p>
</section>
<section id="sending-supported-commands-to-pan-node">
<h4><span class="section-number">2.2.2.6. </span>Sending Supported Commands to PAN Node<a class="headerlink" href="#sending-supported-commands-to-pan-node" title="Permalink to this heading"></a></h4>
<p>When a PAN node is included to the network, a Protocol Controller servicing
the node MUST subscribe to the following topic filter to receive
incoming Commands:</p>
<p>&gt; <code class="docutils literal notranslate"><span class="pre">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/&lt;ClusterName&gt;/Commands/+</span></code></p>
<p>It is OPTIONAL for a Protocol Controller to subscribe to the command topic
filter only if the PAN node supports no commands and all attributes are read-only
attributes (i.e., the WriteAttributes command will have no effect).</p>
<p>When the IoT Services (AWS IoT connectors, Web-based UIs, Rules Engines,
Data Loggers, and so on.) want a PAN node to execute a given command, the Clients can
publish a command payload using the respective command topic:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/&lt;ClusterName&gt;/Commands/&lt;CommandName&gt;</span> -
{
<span class="w">  </span><span class="nt">&quot;FieldName1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;FieldName2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span>
}
</pre></div>
</div>
</section>
<section id="commands-generated-by-pan-node">
<h4><span class="section-number">2.2.2.7. </span>Commands Generated by PAN Node<a class="headerlink" href="#commands-generated-by-pan-node" title="Permalink to this heading"></a></h4>
<p>IoT Services SHOULD be able to read the commands that are generated by a
cluster under a UNID/Endpoint to listen to unsolicited events and responses.</p>
<p>The list of generated commands for each PAN node SHOULD be advertised by the
Protocol Controllers in the <em>SupportedGeneratedCommands</em> topic under the Cluster level.</p>
<p>The list of generated commands SHOULD be advertised using a JSON array
containing strings. For example, the list of generated commands for the OnOff
client cluster could look like this:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/SupportedGeneratedCommands</span> -
{
<span class="w">  </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;On&quot;</span><span class="p">,</span><span class="s2">&quot;Off&quot;</span><span class="p">,</span><span class="s2">&quot;Toggle&quot;</span><span class="p">]</span>
}
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No publications to this topic is equivalent to the Protocol Controller
publishing an empty array of strings to indicate no commands can be generated
by this PAN node.</p>
</div>
</section>
<section id="receiving-generated-commands-from-pan-node">
<h4><span class="section-number">2.2.2.8. </span>Receiving Generated Commands from PAN Node<a class="headerlink" href="#receiving-generated-commands-from-pan-node" title="Permalink to this heading"></a></h4>
<p>When a PAN node is included to the network, an IoT Service monitoring
the node SHOULD subscribe to the following topic filter to receive
incoming commands from the PAN node:</p>
<p>&gt; <code class="docutils literal notranslate"><span class="pre">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/&lt;ClusterName&gt;/GeneratedCommands/+`</span></code></p>
<p>It is OPTIONAL for a Protocol Controller to publish to the command topic
since not all PAN nodes can generate commands. IoT Services SHOULD NOT expect
to see publications for all PAN nodes on this topic filter.</p>
<p>When the IoT Services (AWS IoT connectors, Web-based UIs, Rules Engines,
Data Loggers, and so on.) want to receive commands from a PAN node, the Clients can
subscribe to the topic and parse the command payload:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/&lt;ClusterName&gt;/GeneratedCommands/&lt;CommandName&gt;</span> -
{
<span class="w">  </span><span class="nt">&quot;FieldName1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;FieldName2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span>
}
</pre></div>
</div>
</section>
<section id="command-payloads">
<h4><span class="section-number">2.2.2.9. </span>Command Payloads<a class="headerlink" href="#command-payloads" title="Permalink to this heading"></a></h4>
<p>If the command does not have any mandatory fields, an empty JSON object
(i.e., {}) MUST be sent as a payload.</p>
<p>If the command has mandatory fields, the payload MUST contain all of
them. For example, in the ‘Level’ cluster, the ‘MoveToLevel’ command consists
of two mandatory fields (i.e., ‘Level’ and ‘Transition Time’ ).
In this case, the payload MUST be: <code class="docutils literal notranslate"><span class="pre">{&quot;Level&quot;:</span> <span class="pre">100,</span> <span class="pre">&quot;TransitionTime&quot;:</span> <span class="pre">0}</span></code>.</p>
<p>Each property representing a field MUST be of the following JSON types:</p>
<ul class="simple">
<li><p>string</p></li>
<li><p>number</p></li>
<li><p>boolean</p></li>
<li><p>null</p></li>
<li><p>an object, containing boolean types (only for bitmasks)</p></li>
</ul>
<p>Strings MUST be used in command payloads when a descriptive name is
given to the possible values for a given attribute by the DotDot XML files.</p>
<p>If the individual values do not have a description string name, their value MUST
be presented using either a JSON number or boolean. See the
ZCL Cluster Library <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>.</p>
<p>Finally, only JSON objects are allowed for bitmaps/bitmasks when names are
defined in the ZCL Cluster Library <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>. Numbers MUST
NOT be used in this case. For example, the UpdateFlags field of the
ColorLoopSet command in the ColorControl cluster MUST be represented as
follows:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/ColorControl/Commands/ColorLoopSet</span> -
{
<span class="w">  </span><span class="nt">&quot;UpdateFlags&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span>{
<span class="w">    </span><span class="nt">&quot;UpdateAction&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;UpdateDirection&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;UpdateTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;UpdateStartHue&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span>}
}
</pre></div>
</div>
</section>
<section id="writeattributes-generic-command">
<h4><span class="section-number">2.2.2.10. </span>WriteAttributes Generic Command<a class="headerlink" href="#writeattributes-generic-command" title="Permalink to this heading"></a></h4>
<p>A Protocol Controller MUST always publish the desired/reported state of all
mandatory attributes in a cluster, using the Cluster state topic space.
An attribute state can be changed in three ways:</p>
<ul class="simple">
<li><p>Locally on the PAN node</p></li>
<li><p>Using a specific command as described above</p></li>
<li><p>Using a generic command called ‘WriteAttributes’</p></li>
</ul>
<p>For example, an IoT Service MAY issue the following payload to modify
the desired values of writable attributes directly:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Commands/WriteAttributes</span> -
{
<span class="w">  </span><span class="nt">&quot;AttributeName1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;AttributeName2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span>
}
</pre></div>
</div>
<p>Note that all PAN nodes, which support writable attributes MUST be writable directly
using the <em>WriteAttributes</em> Command. Read-only attributes received in this
Command will be ignored. See <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a> for details
about writable/read-only attributes.</p>
<p>To ensure an end-to-end quality of service, a Protocol Controller MUST always
publish the attributes desired/reported state when it detects a state update.
IoT Services can therefore see the effect of their published commands by
subscribing to the cluster <em>Attributes</em> space.</p>
<p>Non-standard attribute cannot be updated or modified using the <em>WriteAttributes</em>
command.</p>
</section>
<section id="forcereadattributes-generic-command">
<h4><span class="section-number">2.2.2.11. </span>ForceReadAttributes Generic Command<a class="headerlink" href="#forcereadattributes-generic-command" title="Permalink to this heading"></a></h4>
<p>The <em>ForceReadAttributes</em> command is used to force an update of specified
attributes that may not be properly reported using standard reporting mechanisms.</p>
<p>The Protocol Controllers are expected to keep track of the state of nodes
attributes as much as they possibly can, without degrading network performance.</p>
<p>If an IoT Service wants to double check the state of an attribute, it can use
the <strong>ForceReadAttributes</strong>. On reception of this command, Protocol Controllers
SHOULD request the latest available data from the network for each attribute
specified in the command. The data SHOULD be published on the <em>reported</em>
MQTT topic for each attribute.</p>
<p><strong>ForceReadAttributes</strong> should be used sparingly because it can generate significant
radio traffic. Protocol Controllers should by default
guarantee a good trade off between timely updates and radio traffic without the
use of <strong>ForceReadAttributes</strong>.</p>
<p>If the newly read value of an attribute matches its previously
reported value, a new MQTT message MAY not be published.</p>
<p>If the payload of the received MQTT command is empty, the Protocol Controller
SHOULD request new data for all supported attributes of that cluster.
For example, an IoT Service MAY issue the following payload to directly read
several attributes of a given cluster</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Commands/ForceReadAttributes</span> -
{
<span class="w">  </span><span class="nt">&quot;value&quot;</span><span class="w"> </span><span class="p">:</span>
<span class="w">    </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;AttributeName1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;AttributeName2&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;AttributeName6&quot;</span>
<span class="w">    </span><span class="p">]</span>
}
</pre></div>
</div>
<p>In response, the Protocol Controller should update the ‘reported’ MQTT topics for
‘AttributeName1’ and ‘AttributeName2’, as discussed in the
<a class="reference internal" href="#unify-specifications-section-reported-and-desired"><span class="std std-ref">Reported and Desired</span></a>.</p>
<p>Another example, an IoT Service MAY issue the following payload to directly read
ALL the attributes of a given cluster</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndPointID&gt;/&lt;ClusterName&gt;/Commands/ForceReadAttributes</span> -
{
<span class="w">  </span><span class="nt">&quot;value&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
}
</pre></div>
</div>
<p>In response, the Protocol Controller should update ALL available attributes
for <em>ClusterName</em>, as specified in <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>.</p>
<p>Note that Protocol Controller may not support the <em>ForceReadAttributes</em>
for any attribute under a cluster. For example, it can be that a Protocol Controller
is able to force read Scenes Cluster attributes but not the SceneTable.</p>
<p><em>ForceReadAttributes</em> is EXPLICITLY not supported for groups or multicast due
to network performance considerations.</p>
</section>
</section>
</section>
<section id="observing-the-effects-of-a-command">
<h2><span class="section-number">2.3. </span>Observing the effects of a command<a class="headerlink" href="#observing-the-effects-of-a-command" title="Permalink to this heading"></a></h2>
<p>An IoT service MAY follow the effect of a published (write-type) command by
observing the associated attributes.</p>
<p>Read type of commands, like ForceReadAttributes, ViewGroup, ViewScene, MAY trigger
Protocol Controllers to interact with PAN nodes, but there will be no guaranteed
feedback on MQTT.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a> is not always fully explicit on how commands and their fields will
affect the value of cluster attributes. The Unify SDK provides a shared
components that links incoming commands to attribute updates, so updates to
desired will be uniform across Protocol Controllers.</p>
</div>
<p>Let’s consider an OnOff Server PAN node. The Protocol Controller MUST publish
its supported attributes and supported commands as a minimum:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="c c-Singleline"># Initial publications by the Protocol Controller</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/SupportedCommands</span> -  {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Off&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;On&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Toggle&quot;</span><span class="p">]</span>}

<span class="c c-Singleline"># IoT Service publishes:</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Commands/Off</span> -  {<span class="w"> </span>}

<span class="c c-Singleline"># Protocol Controller MUST acknowledge reception of the command by updating all affected attributes</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>}

<span class="c c-Singleline"># Protocol Controller Communicates with the node...</span>

<span class="c c-Singleline"># Protocol Controller MUST update the affected attributes again, as part of the outcome of the command</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>}
</pre></div>
</div>
<p>If a Protocol Controller fails to execute a command or if the node reports that
the OnOff attribute is still On (true), the Protocol Controller MUST roll back
the desired value, so that the desired and reported values match again.</p>
<p>Whenever an attribute has a Desired/Reported value mismatch, an IoT Service
can assume that either:</p>
<ul class="simple">
<li><p>The Protocol Controller is trying to communicate with the node to set the values</p></li>
<li><p>The PAN node is performing a transition to the desired value that takes time.</p></li>
</ul>
<p>IoT Services SHOULD use the WriteAttributes commands whenever available if they
wish to keep a high level of certainty between issued commands and their effect
on attributes.</p>
</section>
<section id="pan-nodes-capabilities-vs-zcl-compliance">
<h2><span class="section-number">2.4. </span>PAN Nodes capabilities vs ZCL Compliance<a class="headerlink" href="#pan-nodes-capabilities-vs-zcl-compliance" title="Permalink to this heading"></a></h2>
<p>Protocol Controllers SHOULD do their best to have the devices they expose
resemble devices that comply with the <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>.
It can be simulating attributes, entire clusters, or manipulating values
sent by end nodes.</p>
<p>Protocol Controllers SHOULD simulate cluster servers if needed, so that devices
behave as closely to the actual set of defined Device Types in <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>.</p>
</section>
<section id="clusters-for-lights-switches-doorlock-thermostat-and-occupancy-sensor-applications">
<h2><span class="section-number">2.5. </span>Clusters for Lights, Switches, DoorLock, Thermostat, and Occupancy Sensor Applications<a class="headerlink" href="#clusters-for-lights-switches-doorlock-thermostat-and-occupancy-sensor-applications" title="Permalink to this heading"></a></h2>
<p>The following subsections provide specific cluster examples using the Cluster
state and Commands topics, such as Dimmer lighting, Switch, Door Lock,
Thermostat, and Occupancy Sensor applications. The detailed description of each
cluster can be found in <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a>.</p>
<p>Each cluster has a list of mandatory attributes and commands. All mandatory
attributes in a given cluster MUST be advertised by a Protocol Controller for
all devices/endpoints. All mandatory Commands SHOULD be advertised in the
SupportedCommand topic, when possible.</p>
<section id="groups-cluster-0x0004">
<h3><span class="section-number">2.5.1. </span>Groups Cluster (0x0004)<a class="headerlink" href="#groups-cluster-0x0004" title="Permalink to this heading"></a></h3>
<p>This cluster is used to define group memberships for PAN nodes.</p>
<p>This cluster requires additional attributes, because the <em>Group list</em> is not captured
by its defined attributes. See <a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a> for the
<em>Groups</em> cluster definition.</p>
<p>Each group is identified using a 16 bits unsigned integer value.
Below is an example of a PAN node Group Cluster server:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/ClusterRevision/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/ClusterRevision/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/NameSupport/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span>{<span class="nt">&quot;Supported&quot;</span><span class="p">:</span><span class="kc">true</span>}}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/NameSupport/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span>{<span class="nt">&quot;Supported&quot;</span><span class="p">:</span><span class="kc">true</span>}}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/GroupList/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/GroupList/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/1/Name/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Kitchen nodes&quot;</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/1/Name/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Kitchen nodes&quot;</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/Attributes/2/Name/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Light bulbs&quot;</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Groups/SupportedCommands</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;AddGroup&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ViewGroup&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;GetGroupMembership&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;RemoveGroup&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;RemoveAllGroups&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;AddGroupIfIdentifying&quot;</span><span class="p">]</span><span class="w"> </span>}
</pre></div>
</div>
<p>The only mandatory attribute in the group cluster is the NameSupport attribute.
If a PAN node supports name for groups, it will advertise the assigned names
for each of its groups under the following topics:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;id&gt;/Groups/Attributes/&lt;GroupID&gt;/Name/Reported</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;id&gt;/Groups/Attributes/&lt;GroupID&gt;/Name/Desired</span>
</pre></div>
</div>
<p>The names assigned to each group will be a value containing a string
as in the AddGroup Command GroupName field.</p>
<p><strong>JSON Schema:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Group name objects&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Names assigned to individual groups. (Group cluster)&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;value&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The list of groups that a node is part of will be advertised under the GroupList
topic. Note that GroupID 0 is not a valid group and MUST NOT be used.</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;id&gt;/Groups/Attributes/GroupList/Desired</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;id&gt;/Groups/Attributes/GroupList/Reported</span>
</pre></div>
</div>
<p><strong>JSON Schema:</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GroupList Object&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;List of Groups that a PAN Node belongs to. (Group cluster)&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;integer&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;minimum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;maximum&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">65535</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;value&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="scenes-cluster-0x0005">
<h3><span class="section-number">2.5.2. </span>Scenes Cluster (0x0005)<a class="headerlink" href="#scenes-cluster-0x0005" title="Permalink to this heading"></a></h3>
<p>The usage of this cluster for application level control is described in
<a class="reference internal" href="Chapter07-scenes.html#unify-specifications-chapter-scenes"><span class="std std-ref">The Dotdot Scenes Cluster (0x0005) in the Unify Framework</span></a>.</p>
</section>
<section id="on-off-cluster-0x0006">
<h3><span class="section-number">2.5.3. </span>On/Off Cluster (0x0006)<a class="headerlink" href="#on-off-cluster-0x0006" title="Permalink to this heading"></a></h3>
<p>Here is an example of OnOff Server PAN node with the minimum required attributes
and commands.</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/SupportedCommands</span> -  {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Off&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;On&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Toggle&quot;</span><span class="p">]</span>}
</pre></div>
</div>
</section>
<section id="level-cluster-0x0008">
<h3><span class="section-number">2.5.4. </span>Level Cluster(0x0008)<a class="headerlink" href="#level-cluster-0x0008" title="Permalink to this heading"></a></h3>
<p>The level cluster controls the light brightness level,
the door closure level, or the heater power output.</p>
<p><a class="reference external" href="https://zigbeealliance.org/wp-content/uploads/2019/12/07-5123-06-zigbee-cluster-library-specification.pdf">ZCL 2019</a> indicates that Level Servers must also be OnOff servers.
Here is a minimal example:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="c c-Singleline"># OnOff Cluster</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/ClusterRevision/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/SupportedCommands</span> -  {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Off&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;On&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Toggle&quot;</span><span class="p">]</span>}

<span class="c c-Singleline"># Level Cluster</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/ClusterRevision/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/ClusterRevision/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">255</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">255</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/SupportedCommands</span> -  {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;MoveToLevel&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Move&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Step&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Stop&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MoveToLevelWithOnOff&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;MoveWithOnOff&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;StepWithOnOff&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;StopWithOnOff&quot;</span><span class="p">]</span>}
</pre></div>
</div>
<p>Note that the OnOff cluster command will affect the level value.</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="c c-Singleline"># IoT Service publishes:</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Commands/Off</span> - {<span class="w"> </span>}

<span class="c c-Singleline"># Protocol Controller acknowledges:</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>}

<span class="c c-Singleline"># Communication ongoing ...</span>

<span class="c c-Singleline"># Protocol Controller updates the state of the PAN node:</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>}

<span class="c c-Singleline"># Alternatively, Level commands May affect OnOff attributes:</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Commands/MoveToLevelWithOnOff</span> - {<span class="nt">&quot;Level&quot;</span><span class="p">:</span><span class="mi">45</span><span class="p">,</span><span class="nt">&quot;TransitionTime&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nt">&quot;OptionsMask&quot;</span><span class="p">:</span>{<span class="nt">&quot;ExecuteIfOff&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&quot;CoupleColorTempToLevel&quot;</span><span class="p">:</span><span class="kc">false</span>}<span class="p">,</span><span class="nt">&quot;OptionsOverride&quot;</span><span class="p">:</span>{<span class="nt">&quot;ExecuteIfOff&quot;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&quot;CoupleColorTempToLevel&quot;</span><span class="p">:</span><span class="kc">false</span>}}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span>}
<span class="c c-Singleline"># Communication ongoing ...</span>
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/OnOff/Attributes/OnOff/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Level/Attributes/CurrentLevel/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">255</span>}
</pre></div>
</div>
<p>Note that the IoT Service SHOULD assume default values for the MinLevel/MaxLevel
if they are not published/advertised for a node.</p>
</section>
<section id="door-lock-cluster-0x0101">
<h3><span class="section-number">2.5.5. </span>Door Lock Cluster (0x0101)<a class="headerlink" href="#door-lock-cluster-0x0101" title="Permalink to this heading"></a></h3>
<p>This cluster is used as a generic interface to secure a door. The ZCL Door Lock
cluster contains a lot of optional attributes, such as logging events,
alarms, security setting, and so on and commands, such as setting user PIN, getting
log events, setting schedules, and so on. However, this section lists only the mandatory
attributes and commands used for basic door operations.</p>
<p>Mandatory Attributes:</p>
<ul class="simple">
<li><p>LockState (0x0000): NotFullyLocked (0x00), Locked (0x01), Unlocked (0x02) and Undefined (0xFF) are the possible attribute values that describe the state of the door.</p></li>
<li><p>LockType(0x0001): defines the door lock types such as Deadbolt (0x00), Magnetic (0x01), Other (0x02), Latch Bolt (0x05) and etc.</p></li>
<li><p>ActuatorEnabled (0x002): defines if the actuator is Enables (true) or Disable (false).</p></li>
</ul>
<p>Mandatory Request Commands (client to a device):</p>
<ul class="simple">
<li><p>LockDoor (0x00): a command used to lock a door with PINOrRFIDCode code.</p></li>
<li><p>UnlockDoor( 0x01): a command used to unlock the door with PINOrRFIDCode Code.</p></li>
</ul>
<p>Note if the PIN or RFID is not defined on the device, the PINOrRFIDCode field value can be empty string (i.e., ” “).</p>
</section>
<section id="thermostat-cluster-0x0201">
<h3><span class="section-number">2.5.6. </span>Thermostat Cluster (0x0201)<a class="headerlink" href="#thermostat-cluster-0x0201" title="Permalink to this heading"></a></h3>
<p>This cluster defines the interface to thermostats.
The ZCL Thermostat cluster contains a lot of optional attributes, such as
Outdoor Temperature, Occupancy, PID configuration, and so on, and a few
optional commands used primarily for scheduling.
However, this section only covers the (only) mandatory attribute,
LocalTemperature, as well as the (only) mandatory command,
Setpoint Raise/Lower.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the ZCL Thermostat Cluster, all temperatures are in <strong>Celcius (°C)</strong>
and any necessary conversion to/from, for example, Fahrenheit °F must be
done by the Unify components (Protocol Controllers and GUI).</p>
</div>
<section id="mandatory-attributes">
<h4><span class="section-number">2.5.6.1. </span>Mandatory Attributes<a class="headerlink" href="#mandatory-attributes" title="Permalink to this heading"></a></h4>
<p>The following attributes are mandatory for the ZigBee thermostat cluster.</p>
<ul class="simple">
<li><p>LocalTemperature (0x0000): The temperature in <strong>Celsius (°C)</strong> multiplied
by 100 measured by the Thermostat. This gives a resolution of 0.01°C.
This is mapped from the Multilevel Sensor Report for the “Air temperature”
sensor type.</p></li>
<li><p>OccupiedCoolingSetpoint (0x0011) indicates the configured temperature
setpoint for the thermostat when it operates in Cooling mode. This value
is writable directly, which is supported only if the node supports
0x02 (COOL) or 0x03 (AUTO) modes.</p></li>
<li><p>OccupiedHeatingSetpoint (0x0012) indicates the configured temperature
setpoint for the thermostat when it operates in Heating mode. This value
is writable directly, which is supported only if the node supports 0x01
(HEAT) or 0x03 (AUTO) modes.</p></li>
<li><p>SystemMode (0x001C) indicates the current operating mode in the system.
Note that all modes are not supported. Only 0 (Off) is supported by default.
Other modes are supported only if the respective Z-Wave mode is supported
(Auto, Cool and Heat).</p></li>
<li><p>ControlSequenceOfOperation (0x001B): This indicates the supported SystemModes
and restricts which ones can be used. This attribute should be writable,
but not all values are mandatory to support. To start with, this attribute
will be mapped based on the supported modes in the Z-Wave Thermostat Mode.
Only values 0x00, 0x02 or 0x04 will be used and the “With reheat” option
will not be used. Since only 1 value is supported, it will appear as if
this attribute is read-only.</p></li>
</ul>
<p>Read only attributes:</p>
<ul class="simple">
<li><p>ThermostatProgrammingOperationMode (0x0025): This attribute is read only,
showing the thermostats’ capabilities. Z-Wave Thermostats will have
SimpleOrSetpoint support to start with. When the Schedule Command Class
is supported, the Schedule bit will be updated to 1.</p></li>
</ul>
<p>Typically, the state topic for the Thermostat cluster will look like this:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ClusterRevision/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ClusterRevision/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/LocalTemperature/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2300</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/LocalTemperature/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2300</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedCoolingSetpoint/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2600</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedCoolingSetpoint/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2600</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedHeatingSetpoint/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2100</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/OccupiedHeatingSetpoint/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2100</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/SystemMode/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Auto&quot;</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/SystemMode/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Auto&quot;</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ThermostatProgrammingOperationMode/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ThermostatProgrammingOperationMode/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ControlSequenceOfOperation/Desired</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>}
<span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;EndpointId&gt;/Thermostat/Attributes/ControlSequenceOfOperation/Reported</span> - {<span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>}
</pre></div>
</div>
</section>
<section id="mandatory-commands">
<h4><span class="section-number">2.5.6.2. </span>Mandatory Commands<a class="headerlink" href="#mandatory-commands" title="Permalink to this heading"></a></h4>
<p>Only one command is mandatory command (alongside WriteAttributes), which allows
changing the operating mode and applying an offset to the currently-configured
setpoints.</p>
<ul class="simple">
<li><p>SetpointRaiseOrLower Command (0x00).</p></li>
</ul>
<p>This command is used to change the Mode and adjust the setpoint(s).
For example, to change to heat mode and increase by 1 degree:</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;id&gt;/Thermostat/Commands/SetpointRaiseOrLower</span> -
{
<span class="w">  </span><span class="nt">&quot;Mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Heat&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;Amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span>
}
</pre></div>
</div>
<p>The mode field can take the following values: “Heat”, “Cool” or “Auto”.</p>
<p>The Amount field in the SetpointRaiseOrLower will trigger a change in the setpoint.
This value is signed. OccupiedCoolingSetpoint and OccupiedHeatingSetpoint are
the two possible setpoints.</p>
<p>If the Mode field is set to Heat or Auto, the OccupiedHeatingSetpoint
(if supported) will be adjusted by the amount indicated in the Amount field.</p>
<p>If the Mode field is set to Cool or Auto, the OccupiedCoolingSetpoint
(if supported) will be adjusted by the amount indicated in the Amount field.</p>
<ul class="simple">
<li><p>WriteAttributes Command.</p></li>
</ul>
<p>This command can be used to directly modify the writable attributes.</p>
<div class="highlight-mqtt notranslate"><div class="highlight"><pre><span></span><span class="ow">ucl/by-unid/&lt;UNID&gt;/ep&lt;id&gt;/Thermostat/Commands/WriteAttributes</span> -
{
<span class="w">  </span><span class="nt">&quot;SystemMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Auto&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;OccupiedCoolingSetpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3200</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;OccupiedHeatingSetpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2200</span>
}
</pre></div>
</div>
<p>Note that it is not possible to detect which SystemModes are supported or if
the setpoints will be accepted. For example, in most cases the
<cite>ControlSequenceOfOperation</cite> will have only 1 valid value. In this case, the
cluster state topic will reflect back that no change was applied.</p>
</section>
</section>
<section id="occupancy-sensing-cluster-0x0406">
<h3><span class="section-number">2.5.7. </span>Occupancy Sensing Cluster (0x0406)<a class="headerlink" href="#occupancy-sensing-cluster-0x0406" title="Permalink to this heading"></a></h3>
<p>The cluster defines an interface to occupancy sensing functionality including
configuration and getting the occupancy status. Here, only the mandatory
attributes that can enable the basic functionality of occupancy sensing are
described.</p>
<p>Mandatory Attributes:</p>
<ul class="simple">
<li><p>Occupancy (0x0000): is a bitmap and Bit 0 defines the sensed occupancy
(Occupied = 1 and Unoccupied = 0)</p></li>
<li><p>OccupancySensorType (0x0001): defines the occupancy sensor, and the
values can be PIR (0x00), Ultrasonic(0x01), PIR and ultrasonic(0x02) and
Physical contact(0x03).</p></li>
</ul>
<p>There are no supported command for Occupancy Sensing cluster. The
<em>WriteAttributes</em> command will have no effect.</p>
</section>
</section>
<section id="examples-of-application-level-control-using-unify-framework">
<h2><span class="section-number">2.6. </span>Examples of Application Level Control Using Unify Framework<a class="headerlink" href="#examples-of-application-level-control-using-unify-framework" title="Permalink to this heading"></a></h2>
<section id="turning-on-the-on-off-light-device-using-unify-framework">
<h3><span class="section-number">2.6.1. </span>Turning On the On/Off Light Device using Unify Framework<a class="headerlink" href="#turning-on-the-on-off-light-device-using-unify-framework" title="Permalink to this heading"></a></h3>
<p>The following diagram shows an example of On/Off Cluster control using the
Unify framework.</p>
<p class="plantuml">
<img src="../../_images/plantuml-728899b00ae8c788d63c72d07c7b9a5cfb336813.png" alt="' Allows to do simultaneous transmissions
!pragma teoz true

' Style for the diagram
!theme plain
skinparam LegendBackgroundColor #F0F0F0

title On Off node control example using the UCL / Unify Framework

legend top
&lt;font color=#0039FB&gt;MQTT Subscription&lt;/font&gt;
&lt;font color=#00003C&gt;Retained MQTT Publication&lt;/font&gt;
&lt;font color=#6C2A0D&gt;Unretained MQTT Publication&lt;/font&gt;
endlegend

' List of participants
participant &quot;IoT Service&quot; as iot_service
participant &quot;MQTT Broker&quot; as mqtt_broker
participant &quot;Protocol Controller&quot; as protocol_controller
participant &quot;PAN Node&quot; as pan_node

iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OnOff/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OnOff/SupportedCommands&lt;/font&gt;
protocol_controller -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OnOff/Commands/+&lt;/font&gt;

rnote over iot_service, pan_node: Node inclusion and capabilities discovery

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: false }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: false }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/SupportedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[ &quot;On&quot;, &quot;Off&quot;, &quot;Toggle&quot;]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

iot_service -&gt; mqtt_broker
&amp; mqtt_broker -&gt; protocol_controller : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/OnOff/Commands/On \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ }&lt;/b&gt;

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: true }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; pan_node : PHY command
pan_node -&gt; protocol_controller : PHY command

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: true }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service"/>
</p>
</section>
<section id="changing-the-brightness-level-of-the-light-using-unify-framework">
<h3><span class="section-number">2.6.2. </span>Changing the Brightness Level of the Light Using Unify Framework<a class="headerlink" href="#changing-the-brightness-level-of-the-light-using-unify-framework" title="Permalink to this heading"></a></h3>
<p>The following diagram shows an example of a device with both On/Off and Level
Clusters server.</p>
<p class="plantuml">
<img src="../../_images/plantuml-9a1928baac7977fda1cb0f1b0ceac02297e4f57c.png" alt="' Allows to do simultaneous transmissions
!pragma teoz true

' Style for the diagram
!theme plain
skinparam LegendBackgroundColor #F0F0F0

title Dimmer node example using the UCL / Unify Framework

legend top
&lt;font color=#0039FB&gt;MQTT Subscription&lt;/font&gt;
&lt;font color=#00003C&gt;Retained MQTT Publication&lt;/font&gt;
&lt;font color=#6C2A0D&gt;Unretained MQTT Publication&lt;/font&gt;
endlegend

' List of participants
participant &quot;IoT Service&quot; as iot_service
participant &quot;MQTT Broker&quot; as mqtt_broker
participant &quot;Protocol Controller&quot; as protocol_controller
participant &quot;PAN Node&quot; as pan_node

iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OnOff/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OnOff/SupportedCommands&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Level/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Level/SupportedCommands&lt;/font&gt;

protocol_controller -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OnOff/Commands/+&lt;/font&gt;
protocol_controller -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Level/Commands/+&lt;/font&gt;

rnote over iot_service, pan_node: Node inclusion and capabilities discovery

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: false }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: false }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/SupportedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[ &quot;On&quot;, &quot;Off&quot;, &quot;Toggle&quot;, &quot;WriteAttributes&quot; ]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/CurrentLevel/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: 0 }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Level/Attributes/CurrentLevel/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: 0 }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Level/SupportedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;: [ &quot;MoveToLevel&quot;, &quot;Move&quot;, &quot;Step&quot;, &quot;Stop&quot;, &quot;MoveToLevelWithOnOff&quot;, \n&lt;font color=#00003C&gt;&lt;b&gt;&quot;MoveWithOnOff&quot;, &quot;StepWithOnOff&quot;, &quot;StopWithOnOff&quot;, &quot;WriteAttributes&quot; ]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

== ==

iot_service -&gt; mqtt_broker
&amp; mqtt_broker -&gt; protocol_controller : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/Level/Commands/MoveToLevelWithOnOff \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ &quot;Level&quot; : 50, &quot;TransitionTime&quot; : 50, &quot;OptionsMask&quot; : 0 , &quot;OptionsOverride&quot; : 0 }&lt;/b&gt;

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: true }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Level/Attributes/CurrentLevel/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: 50 }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; pan_node : PHY command
pan_node -&gt; protocol_controller : PHY command

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OnOff/Attributes/OnOff/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: true }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Level/Attributes/CurrentLevel/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: 50 }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service"/>
</p>
<p>### DoorLock Operation Using Unify Framework</p>
<p>The following diagram shows an example of a Door Lock controlled using the
Unify Framework.</p>
<p class="plantuml">
<img src="../../_images/plantuml-ab6915f6a8f107f08ae60d97ba820459d5eb0e4f.png" alt="' Allows to do simultaneous transmissions
!pragma teoz true

' Style for the diagram
!theme plain
skinparam LegendBackgroundColor #F0F0F0

title Door Lock node control example using the UCL / Unify Framework

legend top
&lt;font color=#0039FB&gt;MQTT Subscription&lt;/font&gt;
&lt;font color=#00003C&gt;Retained MQTT Publication&lt;/font&gt;
&lt;font color=#6C2A0D&gt;Unretained MQTT Publication&lt;/font&gt;
endlegend

' List of participants
participant &quot;IoT Service&quot; as iot_service
participant &quot;MQTT Broker&quot; as mqtt_broker
participant &quot;Protocol Controller&quot; as protocol_controller
participant &quot;PAN Node&quot; as pan_node

iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/SupportedCommands&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/SupportedGeneratedCommands&lt;/font&gt;
protocol_controller -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/Commands/+&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/GeneratedCommands/+&lt;/font&gt;

rnote over iot_service, pan_node: Node inclusion and capabilities discovery

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/LockType/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;LatchBolt&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/LockType/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;LatchBolt&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/LockState/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Unlocked&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/LockState/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Unlocked&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/ActuatorEnabled/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: true }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/ActuatorEnabled/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: true }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/SupportedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[ &quot;LockDoor&quot;, &quot;UnlockDoor&quot;, &quot;WriteAttributes&quot; ]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service
protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/SupportedGeneratedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[ &quot;LockDoorResponse&quot;, &quot;UnlockDoorResponse&quot;]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

iot_service -&gt; mqtt_broker
&amp; mqtt_broker -&gt; protocol_controller : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Commands/LockDoor \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ &quot;PINOrRFIDCode&quot;: &quot;1234&quot; }&lt;/b&gt;
protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/LockState/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Locked&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; pan_node : PHY command
pan_node -&gt; protocol_controller : PHY command

protocol_controller -&gt; mqtt_broker : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/DoorLock/GeneratedCommands/LockDoorResponse \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ &quot;Status&quot;: &quot;SUCCESS&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/Attributes/LockState/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Locked&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service"/>
</p>
</section>
<section id="doorlockcontroller-operation-using-unify-framework">
<h3><span class="section-number">2.6.3. </span>DoorLockController Operation Using Unify Framework<a class="headerlink" href="#doorlockcontroller-operation-using-unify-framework" title="Permalink to this heading"></a></h3>
<p>The following diagram shows an example of a Door Lock Controller being used in the
Unify Framework.</p>
<p class="plantuml">
<img src="../../_images/plantuml-9fbd892fe44e465e09e8753dfa2dd263b1ae9682.png" alt="' Allows to do simultaneous transmissions
!pragma teoz true

' Style for the diagram
!theme plain
skinparam LegendBackgroundColor #F0F0F0

title Door Lock node control example using the UCL / Unify Framework

legend top
&lt;font color=#0039FB&gt;MQTT Subscription&lt;/font&gt;
&lt;font color=#00003C&gt;Retained MQTT Publication&lt;/font&gt;
&lt;font color=#6C2A0D&gt;Unretained MQTT Publication&lt;/font&gt;
endlegend

' List of participants
participant &quot;IoT Service&quot; as iot_service
participant &quot;MQTT Broker&quot; as mqtt_broker
participant &quot;Protocol Controller&quot; as protocol_controller
participant &quot;PAN Node&quot; as pan_node

iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/GeneratedCommands&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/SupportedCommands&lt;/font&gt;
protocol_controller -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/Commands/+&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/DoorLock/GeneratedCommands/+&lt;/font&gt;

rnote over iot_service, pan_node: Node inclusion and capabilities discovery

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/SupportedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[ &quot;LockDoorResponse&quot;, &quot;UnlockDoorResponse&quot;]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service
protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/DoorLock/SupportedGeneratedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[ &quot;LockDoor&quot;, &quot;UnlockDoor&quot;]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service
...
rnote over iot_service, pan_node: Lock Door command initiated from a stimulus (button pressed)

pan_node -&gt; protocol_controller : LockDoor command sent over PHY
protocol_controller -&gt; mqtt_broker : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/DoorLock/GeneratedCommands/LockDoor \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ &quot;PINOrRFIDCode&quot;: &quot;4567&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service
rnote over iot_service, pan_node: IoT Service processes LockDoor command (assuming the IoT Service evaluates the security level of the PAN node as acceptable)"/>
</p>
</section>
<section id="pir-sensor-notification-application-using-unify-framework">
<h3><span class="section-number">2.6.4. </span>PIR Sensor Notification Application Using Unify Framework<a class="headerlink" href="#pir-sensor-notification-application-using-unify-framework" title="Permalink to this heading"></a></h3>
<p>The following diagram shows an example of PIR Sensor device
represented as an OccupancySensing Cluster server with the Unify framework.</p>
<p class="plantuml">
<img src="../../_images/plantuml-fba4a53e1c512dec437073dc13667e0b4e0fcbb9.png" alt="' Allows to do simultaneous transmissions
!pragma teoz true

' Style for the diagram
!theme plain
skinparam LegendBackgroundColor #F0F0F0

title Occupancy Sensing example using the UCL / Unify Framework

legend top
&lt;font color=#0039FB&gt;MQTT Subscription&lt;/font&gt;
&lt;font color=#00003C&gt;Retained MQTT Publication&lt;/font&gt;
&lt;font color=#6C2A0D&gt;Unretained MQTT Publication&lt;/font&gt;
endlegend

' List of participants
participant &quot;IoT Service&quot; as iot_service
participant &quot;MQTT Broker&quot; as mqtt_broker
participant &quot;Protocol Controller&quot; as protocol_controller
participant &quot;PAN Node&quot; as pan_node

iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OccupancySensing/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/OccupancySensing/SupportedCommands&lt;/font&gt;
protocol_controller -&gt; mqtt_broker: &lt;b&gt;Optional&lt;/b&gt; (&lt;font color=#0039FB&gt;ucl/by-unid/+/+/OccupancySensing/Commands/+&lt;/font&gt;)

rnote over iot_service, pan_node: Node inclusion and capabilities discovery

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/Occupancy/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {SensedOccupancy : false} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/Occupancy/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {SensedOccupancy : false} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/OccupancySensorType/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;PIR&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/OccupancySensorType/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;PIR&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/SupportedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[ ]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

== ==

pan_node -&gt; protocol_controller : PHY Specific \nPIR occupancy \ndetected

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/Occupancy/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {SensedOccupancy : true} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/Occupancy/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {SensedOccupancy : true} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

== ==

pan_node -&gt; protocol_controller : PHY Specific \nPIR occupancy \nnot detected

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/Occupancy/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {SensedOccupancy : false} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/OccupancySensing/Attributes/Occupancy/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {SensedOccupancy : false} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service"/>
</p>
</section>
<section id="using-the-writeattributes-generic-command">
<h3><span class="section-number">2.6.5. </span>Using the WriteAttributes Generic Command<a class="headerlink" href="#using-the-writeattributes-generic-command" title="Permalink to this heading"></a></h3>
<p>Scenario: A device supports the <code class="docutils literal notranslate"><span class="pre">ManufacturerName</span></code> and <code class="docutils literal notranslate"><span class="pre">LocationDescription</span></code>
attributes in the Basic Cluster. An MQTT Client wants to update the location of
the device using the <em>WriteAttributes</em> Command.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">ManufacturerName</span></code> is a read only attribute
and the <code class="docutils literal notranslate"><span class="pre">LocationDescription</span></code> is a writable attribute.</p>
<p class="plantuml">
<img src="../../_images/plantuml-12d805cba4fdf0f4868b6969b51acbb53acd2428.png" alt="' Allows to do simultaneous transmissions
!pragma teoz true

' Style for the diagram
!theme plain
skinparam LegendBackgroundColor #F0F0F0

title Writing to attributes with the WriteAttributes Command.

legend top
&lt;font color=#0039FB&gt;MQTT Subscription&lt;/font&gt;
&lt;font color=#00003C&gt;Retained MQTT Publication&lt;/font&gt;
&lt;font color=#6C2A0D&gt;Unretained MQTT Publication&lt;/font&gt;
endlegend

' List of participants
participant &quot;IoT Service&quot; as iot_service
participant &quot;MQTT Broker&quot; as mqtt_broker
participant &quot;Protocol Controller&quot; as protocol_controller
participant &quot;PAN Node&quot; as pan_node

iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Basic/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Basic/SupportedCommands&lt;/font&gt;
protocol_controller -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Basic/Commands/+&lt;/font&gt;

== ==

iot_service -&gt; mqtt_broker
&amp; mqtt_broker -&gt; protocol_controller : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/Basic/Commands/WriteAttributes \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ &quot;LocationDescription&quot;: &quot;Bathroom&quot;, &quot;ManufacturerName&quot; : &quot;Silabs&quot; }&lt;/b&gt;

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Basic/Attributes/LocationDescription/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Bathroom&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; pan_node : PHY command
pan_node -&gt; protocol_controller : PHY command

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Basic/Attributes/LocationDescription/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Bathroom&quot; }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service"/>
</p>
</section>
<section id="manipulating-pan-node-group-membership">
<h3><span class="section-number">2.6.6. </span>Manipulating PAN Node Group Membership<a class="headerlink" href="#manipulating-pan-node-group-membership" title="Permalink to this heading"></a></h3>
<p>The following diagram shows an example of adding/removing groups for a PAN
node</p>
<p class="plantuml">
<img src="../../_images/plantuml-f91ae3ab5db2657afa4596864ffb3336eb172e92.png" alt="' Allows to do simultaneous transmissions
!pragma teoz true

' Style for the diagram
!theme plain
skinparam LegendBackgroundColor #F0F0F0

title Group membership manipulation with the Group Cluster using the UCL / Unify Framework

legend top
&lt;font color=#0039FB&gt;MQTT Subscription&lt;/font&gt;
&lt;font color=#00003C&gt;Retained MQTT Publication&lt;/font&gt;
&lt;font color=#6C2A0D&gt;Unretained MQTT Publication&lt;/font&gt;
endlegend

' List of participants
participant &quot;IoT Service&quot; as iot_service
participant &quot;MQTT Broker&quot; as mqtt_broker
participant &quot;Protocol Controller&quot; as protocol_controller
participant &quot;PAN Node&quot; as pan_node

iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Groups/Attributes/#&lt;/font&gt;
iot_service -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Groups/SupportedCommands&lt;/font&gt;
protocol_controller -&gt; mqtt_broker: &lt;font color=#0039FB&gt;ucl/by-unid/+/+/Groups/Commands/+&lt;/font&gt;

rnote over iot_service, pan_node: Node inclusion and capabilities discovery

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/NameSupport/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {&quot;Supported&quot;:true} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/NameSupport/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: {&quot;Supported&quot;:true} }&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/GroupList/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/GroupList/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/SupportedCommands \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;: [&quot;AddGroup&quot;, &quot;ViewGroup&quot;, &quot;GetGroupMembership&quot;, \n&lt;font color=#00003C&gt;&lt;b&gt;&quot;RemoveGroup&quot;, &quot;RemoveAllGroups&quot;, &quot;AddGroupIfIdentifying&quot;]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

== ==

iot_service -&gt; mqtt_broker
&amp; mqtt_broker -&gt; protocol_controller : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/Groups/Commands/AddGroup \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ &quot;GroupId&quot; : 1, &quot;GroupName&quot;: &quot;Living room&quot;}&lt;/b&gt;

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/GroupList/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[1]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/1/Name/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Living room&quot;}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

pan_node &lt;-&gt; protocol_controller : PHY commands

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/GroupList/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[1]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/1/Name/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{ &quot;value&quot;: &quot;Living room&quot;}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

== ==
iot_service -&gt; mqtt_broker
&amp; mqtt_broker -&gt; protocol_controller : &lt;font color=#6C2A0D&gt;ucl/by-unid/zw-1234/ep0/Groups/Commands/RemoveGroup \n&lt;font color=#6C2A0D&gt;&lt;b&gt;{ &quot;GroupId&quot; : 1}&lt;/b&gt;

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/GroupList/Desired \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/1/Name/Desired \n&lt;font color=#00003C&gt;
&amp; mqtt_broker -&gt; iot_service

pan_node &lt;-&gt; protocol_controller : PHY commands

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/GroupList/Reported \n&lt;font color=#00003C&gt;&lt;b&gt;{&quot;value&quot;:[]}&lt;/b&gt;
&amp; mqtt_broker -&gt; iot_service

protocol_controller -&gt; mqtt_broker : &lt;font color=#00003C&gt;ucl/by-unid/zw-1234/ep0/Groups/Attributes/1/Name/Reported \n&lt;font color=#00003C&gt;
&amp; mqtt_broker -&gt; iot_service"/>
</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>
    <hr/>
    <p>Copyright © 2023 Silicon Laboratories. All rights reserved.</p>
</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>