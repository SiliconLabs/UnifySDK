<?xml version="1.0"?>
<!--
ConfigurationParameters
This is a manufacturer specific cluster.
-->
<zcl:cluster xmlns:zcl="http://zigbee.org/zcl/clusters"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:type="http://zigbee.org/zcl/types"
  xmlns:xi="http://www.w3.org/2001/XInclude" xsi:schemaLocation="http://zigbee.org/zcl/clusters cluster.xsd http://zigbee.org/zcl/types type.xsd" id="FD08" revision="1" name="UserCredential">
  <classification role="application" picsCode="USRCRED" />


  <type:type short="UserTypeEnum" name="UserTypeEnum" id="10" inheritsFrom="enum8">
    <restriction>
      <type:enumeration value="00" name="GeneralUser" />
      <!-- Reserved for future use
      <type:enumeration value="01" name="RESERVED"/>
      <type:enumeration value="02" name="RESERVED"/> 
      -->
      <type:enumeration value="03" name="ProgrammingUser"/>
      <type:enumeration value="04" name="NonAccessUser"/>
      <type:enumeration value="05" name="DuressUser"/>
      <type:enumeration value="06" name="DisposableUser"/>
      <type:enumeration value="07" name="ExpiringUser"/>
      <!-- Reserved for future use
      <type:enumeration value="08" name="RESERVED"/>
      -->
      <type:enumeration value="09" name="RemoteOnlyUser"/>
    </restriction>
  </type:type>
  <type:type short="CredRule" name="CredRule" id="11" inheritsFrom="enum8">
    <restriction>
      <type:enumeration value="01" name="Single" />
      <type:enumeration value="02" name="Dual"/>
      <type:enumeration value="03" name="Triple"/>
    </restriction>
  </type:type>
  <type:type short="CredType" name="CredType" id="12" inheritsFrom="enum8">
    <restriction>
      <type:enumeration value="01" name="PINCode"/>
      <type:enumeration value="02" name="Password"/>
      <type:enumeration value="03" name="RFIDCode" />
      <type:enumeration value="04" name="BLE" />
      <type:enumeration value="05" name="NFC" />
      <type:enumeration value="06" name="UWB" />
      <type:enumeration value="07" name="EyeBiometric"/>
      <type:enumeration value="08" name="FaceBiometric"/>
      <type:enumeration value="09" name="FingerBiometric"/>
      <type:enumeration value="0A" name="HandBiometric"/>
      <type:enumeration value="0B" name="UnspecifiedBiometric"/>
    </restriction>
  </type:type>
  <type:type short="UserNameEncodingType" name="UserNameEncodingType" id="13" inheritsFrom="enum8">
    <restriction>
      <type:enumeration value="00" name="ASCII"/>
      <type:enumeration value="01" name="OEMExtendedASCII"/>
      <type:enumeration value="02" name="UTF-16" />
    </restriction>
  </type:type>

  <type:type short="UserModifierType" name="UserModifierType" id="20" inheritsFrom="enum8">
    <restriction>
      <type:enumeration value="00" name="DNE"/>
      <type:enumeration value="01" name="Unknown"/>
      <type:enumeration value="02" name="Z-Wave" />
      <type:enumeration value="03" name="Locally" />
      <type:enumeration value="04" name="MobileAppOrOtherIoT"/>
    </restriction>
  </type:type>


  <server>
    <attributes>
      <attribute id="0000" name="SupportedUserUniqueIdentifiers" type="uint16" required="true"/>
      <attribute id="0001" name="SupportedCredentialRules" type="map8" required="true">
        <bitmap>
          <!-- <element name="RESERVED" type="bool" mask="01"/> -->
          <element name="Single" type="bool" mask="02" shiftRight="1" />
          <element name="Dual" type="bool" mask="04" shiftRight="2" />
          <element name="Triple" type="bool" mask="08" shiftRight="3" />
        </bitmap>
      </attribute>
      <attribute id="0002" name="SupportedCredentialTypes" type="map16" required="true">
        <bitmap>
          <element name="PINCode" type="bool" mask="01" />
          <element name="Password" type="bool" mask="02" shiftRight="1" />
          <element name="RFIDCode" type="bool" mask="04" shiftRight="2" />
          <element name="BLE" type="bool" mask="08" shiftRight="2" />
          <element name="NFC" type="bool" mask="10" shiftRight="3" />
          <element name="UWB" type="bool" mask="20" shiftRight="4" />
          <element name="EyeBiometric" type="bool" mask="40" shiftRight="5" />
          <element name="FaceBiometric" type="bool" mask="80" shiftRight="6" />
          <element name="FingerBiometric" type="bool" mask="0100" shiftRight="7" />
          <element name="HandBiometric" type="bool" mask="0200" shiftRight="8" />
          <element name="UnspecifiedBiometric" type="bool" mask="0400" shiftRight="9"/>
        </bitmap>
      </attribute>
      <attribute id="0003" name="SupportedUserTypes" type="map16" required="true">
        <bitmap>
          <element name="GeneralUser" type="bool" mask="01" />
          <!--  Reserved for future use
            <element name="RESERVED" type="bool" mask="02" shiftRight="1" />
          <element name="RESERVED" type="bool" mask="04" shiftRight="2" /> -->
          <element name="ProgrammingUser" type="bool" mask="08" shiftRight="2" />
          <element name="NonAccessUser" type="bool" mask="10" shiftRight="3" />
          <element name="DuressUser" type="bool" mask="20" shiftRight="4" />
          <element name="DisposableUser" type="bool" mask="40" shiftRight="5" />
          <element name="ExpiringUser" type="bool" mask="80" shiftRight="6" />
          <!-- <element name="RESERVED" type="bool" mask="0100" shiftRight="7" /> -->
          <element name="RemoteOnlyUser" type="bool" mask="0200" shiftRight="8" />
        </bitmap>
      </attribute>
      <attribute id="0004" name="SupportCredentialChecksum" type="bool" required="true"/>
      <attribute id="0005" name="SupportAdminPinCode" type="bool" required="true"/>
      <attribute id="0006" name="SupportAdminPinCodeDeactivation" type="bool" required="true"/>
      <attribute id="0007" name="AdminPinCode" type="string"/>
      <!--Users and credentials not appears here due to the lack of options for array types.
      The attributes will be published as read only. See user_credential_cluster_server.h for details -->
    </attributes>
    

    <commands>
      <command id="01" name="AddUser">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="UserType" type="UserTypeEnum" />
          <field name="UserActiveState" type="bool" />
          <field name="CredentialRule" type="CredRule" />
          <field name="UserName" type="string" />
          <field name="ExpiringTimeoutMinutes" type="uint16" presentIf="UserType = 07"/>
          <field name="UserNameEncoding" type="UserNameEncodingType"/>
        </fields>
      </command>
      <command id="02" name="ModifyUser">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="UserType" type="UserTypeEnum" />
          <field name="UserActiveState" type="bool" />
          <field name="CredentialRule" type="CredRule" />
          <field name="UserName" type="string" />
          <field name="ExpiringTimeoutMinutes" type="uint16" presentIf="UserType = 07"/>
          <field name="UserNameEncoding" type="UserNameEncodingType"/>
        </fields>
      </command>
      <command id="03" name="DeleteUser">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
        </fields>
      </command>
      <command id="04" name="AddCredential">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="CredentialType" type="CredType"/>
          <field name="CredentialSlot" type="uint16"/>
          <field name="CredentialData" type="string"/>
        </fields>
      </command>
      <command id="05" name="ModifyCredential">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="CredentialType" type="CredType"/>
          <field name="CredentialSlot" type="uint16"/>
          <field name="CredentialData" type="string"/>
        </fields>
      </command>
      <command id="06" name="DeleteCredential">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="CredentialType" type="CredType"/>
          <field name="CredentialSlot" type="uint16"/>
        </fields>
      </command>
      <command id="07" name="DeleteAllUsers"/>
      <command id="08" name="DeleteAllCredentials"/>
      <command id="09" name="DeleteAllCredentialsByType">
        <fields>
          <field name="CredentialType" type="CredType"/>
        </fields>
      </command>
      <command id="0A" name="DeleteAllCredentialsForUser">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
        </fields>
      </command>
      <command id="0B" name="DeleteAllCredentialsForUserByType">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="CredentialType" type="CredType"/>
        </fields>
      </command>
      <command id="0C" name="CredentialLearnStartAdd">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="CredentialType" type="CredType"/>
          <field name="CredentialSlot" type="uint16"/>
          <field name="CredentialLearnTimeout" type="uint8" default="0"/>
        </fields>
      </command>
      <command id="0D" name="CredentialLearnStartModify">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
          <field name="CredentialType" type="CredType"/>
          <field name="CredentialSlot" type="uint16"/>
          <field name="CredentialLearnTimeout" type="uint8" default="0"/>
        </fields>
      </command>
      <command id="0E" name="CredentialLearnStop"/>
      <command id="0F" name="CredentialAssociation">
        <fields>
          <field name="CredentialType" type="CredType"/>
          <field name="SourceUserUniqueID" type="uint16"/>
          <field name="SourceCredentialSlot" type="uint16"/>
          <field name="DestinationUserUniqueID" type="uint16"/>
          <field name="DestinationCredentialSlot" type="uint16"/>
        </fields>
      </command>
      <command id="10" name="GetUserChecksum">
        <fields>
          <field name="UserUniqueID" type="uint16"/>
        </fields>
      </command>
      <command id="11" name="GetCredentialChecksum">
        <fields>
          <field name="CredentialType" type="CredType"/>
        </fields>
      </command>
      <command id="12" name="GetAllUsersChecksum"/>
      <command id="13" name="SetAdminPINCode">
        <fields>
          <field name="PINCode" type="string"/>
        </fields>
      </command>
      <command id="14" name="DeactivateAdminPINCode"/>
    </commands>
  </server>
</zcl:cluster>
